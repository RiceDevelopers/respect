<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุฅุชูุงู ุงูุทูุจ - Flavus </title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* ุชูุณูู ุฅุถุงูู ููุชุญููู */
    .redirect-message {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 16px;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    
    .progress-bar {
      width: 100%;
      height: 4px;
      background: var(--dark-3);
      border-radius: 2px;
      margin-top: 20px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      width: 0%;
      background: var(--orange);
      transition: width 5s linear;
    }
  </style>
</head>
<body>

<header>
  <div class="header-inner">
    <a href="index.html" class="logo">Flavus <span></span></a>
    <nav>
      <a href="index.html">ุงูุฑุฆูุณูุฉ</a>
      <a href="products.html">ุงูููุชุฌุงุช</a>
    </nav>
    <div class="header-actions">
      <a href="cart.html" class="btn-cart">
        ๐ ุงูุณูุฉ
        <span class="cart-badge cart-count" style="display:none">0</span>
      </a>
    </div>
    <button class="burger"><span></span><span></span><span></span></button>
  </div>
</header>

<div class="page-header">
  <div class="container">
    <div class="section-label">ุงูุฏูุน</div>
    <h1>ุฅุชูุงู <em style="font-style:italic;color:var(--orange)">ุงูุทูุจ</em> ๐ฐ๐ผ</h1>
    <p>ุฏูุน ุนูุฏ ุงูุงุณุชูุงู - ูุง ูุชุทูุจ ุฃู ุจูุงูุงุช ุจูููุฉ - ุงูุชูุตูู ูุฌููุน ูุญุงูุธุงุช ุงููููุช</p>
  </div>
</div>

<!-- STEPS -->
<div style="background:var(--dark-2);border-bottom:1px solid var(--border-subtle)">
  <div class="container" style="padding-top:20px;padding-bottom:20px">
    <div style="display:flex;align-items:center;justify-content:center;gap:0">
      <div class="step active" style="display:flex;align-items:center;gap:8px;color:var(--orange);font-size:13px;font-weight:600">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--orange);color:white;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700">1</div>
        ุจูุงูุงุช ุงูุชูุตูู
      </div>
      <div style="width:60px;height:1px;background:var(--border-subtle);margin:0 12px"></div>
      <div style="display:flex;align-items:center;gap:8px;color:var(--text-muted);font-size:13px">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--dark-3);color:var(--text-muted);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700">2</div>
        ูุฑุงุฌุนุฉ ุงูุทูุจ
      </div>
      <div style="width:60px;height:1px;background:var(--border-subtle);margin:0 12px"></div>
      <div style="display:flex;align-items:center;gap:8px;color:var(--text-muted);font-size:13px">
        <div style="width:28px;height:28px;border-radius:50%;background:var(--dark-3);color:var(--text-muted);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700">3</div>
        ุชุฃููุฏ ุงูุทูุจ
      </div>
    </div>
  </div>
</div>

<section>
  <div class="container">
    <div class="checkout-layout">
      <div>
        <!-- Personal Info -->
        <div class="form-section">
          <h3>๐ค ูุนูููุงุช ุงูุดุฎุตูุฉ</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>ุงูุงุณู ุงูุฃูู *</label>
              <input type="text" class="form-input" id="first-name" placeholder="ูุญูุฏ" required>
            </div>
            <div class="form-group">
              <label>ุงุณู ุงูุนุงุฆูุฉ *</label>
              <input type="text" class="form-input" id="last-name" placeholder="ุงูุนุชูุจู" required>
            </div>
            <div class="form-group">
              <label>ุฑูู ุงูุฌูุงู *</label>
              <input type="tel" class="form-input" id="phone" placeholder="5xxxxxxx" required dir="ltr">
              <small style="color:var(--text-muted);font-size:11px">ุฃุฏุฎู ุงูุฑูู ุจุฏูู ุฑูุฒ ุงูุฏููุฉ (+965)</small>
            </div>
            <div class="form-group">
              <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
              <input type="email" class="form-input" id="email" placeholder="name@email.com" dir="ltr">
            </div>
          </div>
        </div>

        <!-- Address -->
        <div class="form-section">
          <h3>๐ ุนููุงู ุงูุชูุตูู - ุงููููุช</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>ุงููุญุงูุธุฉ *</label>
              <select class="form-input" id="city" required>
                <option value="">ุงุฎุชุฑ ุงููุญุงูุธุฉ</option>
                <option>ูุฏููุฉ ุงููููุช</option>
                <option>ุญููู</option>
                <option>ุงูุณุงูููุฉ</option>
                <option>ุงููุฑูุงููุฉ</option>
                <option>ุงูุฌูุฑุงุก</option>
                <option>ุงูุฃุญูุฏู</option>
                <option>ูุจุงุฑู ุงููุจูุฑ</option>
                <option>ุงููุฑูู</option>
                <option>ุงููุญูุญูู</option>
              </select>
            </div>
            <div class="form-group">
              <label>ุงูููุทูุฉ *</label>
              <input type="text" class="form-input" id="district" placeholder="ุงุณู ุงูููุทูุฉ" required>
            </div>
            <div class="form-group form-full">
              <label>ุงูุดุงุฑุน ูุงูุนููุงู *</label>
              <input type="text" class="form-input" id="street" placeholder="ุงุณู ุงูุดุงุฑุนุ ุฑูู ุงููุจููุ ุงูุดูุฉ..." required>
            </div>
            <div class="form-group">
              <label>ุงูุฑูุฒ ุงูุจุฑูุฏู</label>
              <input type="text" class="form-input" id="postal" placeholder="ูุซุงู: 30000" dir="ltr">
            </div>
            <div class="form-group">
              <label>ููุช ุงูุชูุตูู ุงูููุถู</label>
              <select class="form-input" id="delivery-time">
                <option>ุฃู ููุช</option>
                <option>ุงูุตุจุงุญ (9ุต - 12ู)</option>
                <option>ุงูุธูุฑ (12ู - 4ู)</option>
                <option>ุงููุณุงุก (4ู - 9ู)</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Notes -->
        <div class="form-section">
          <h3>๐ ููุงุญุธุงุช ุฅุถุงููุฉ</h3>
          <div class="form-group">
            <label>ููุงุญุธุงุช ููููุฏูุจ (ุงุฎุชูุงุฑู)</label>
            <textarea class="form-input" id="notes" rows="4" placeholder="ุฃู ุชุนูููุงุช ุฎุงุตุฉ ููุชูุตูู ุฃู ุชุบููู ุงููุฏูุฉ..."></textarea>
          </div>
        </div>

        <!-- Payment Method -->
        <div class="form-section">
          <h3>๐ณ ุทุฑููุฉ ุงูุฏูุน</h3>
          <div style="background:var(--orange-glow);border:2px solid var(--orange);border-radius:10px;padding:20px;display:flex;align-items:center;gap:16px">
            <div style="font-size:32px">๐ต</div>
            <div>
              <h4 style="color:var(--orange);margin-bottom:4px">ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู</h4>
              <p style="font-size:13px;color:var(--text-secondary)">ุงุฏูุน ููุฏุงู (ุฏููุงุฑ ูููุชู) ุนูุฏ ุงุณุชูุงู ุทูุจู ูู ุงููููุช.</p>
            </div>
            <div style="margin-right:auto;background:var(--orange);color:white;padding:4px 12px;border-radius:20px;font-size:11px;font-weight:700">ุงูุทุฑููุฉ ุงููุญูุฏุฉ</div>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <div class="cart-summary">
        <h3 class="summary-title">ููุฎุต ุทูุจู</h3>
        <div id="order-items" style="margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid var(--border-subtle)"></div>
        <div class="summary-row">
          <span>ุงููุฌููุน ุงููุฑุนู</span>
          <span id="summary-subtotal">0 ุฏ.ู</span>
        </div>
        <div class="summary-row">
          <span>ุงูุดุญู</span>
          <span id="summary-shipping">ูุฌุงูู</span>
        </div>
        <div class="summary-row">
          <span>ุงูุถุฑูุจุฉ (0%)</span>
          <span id="summary-tax">0 ุฏ.ู</span>
        </div>
        <div class="summary-row total">
          <span>ุงูุฅุฌูุงูู</span>
          <span id="summary-total">0 ุฏ.ู</span>
        </div>

        <div class="cod-notice">
          <div class="cod-icon">๐ฐ๐ผ</div>
          <div>ุงุฏูุน ููุฏุงู (ุฏููุงุฑ ูููุชู) ููููุฏูุจ ุนูุฏ ุงูุงุณุชูุงู ูู ุงููููุช. ุงูุฎุฏูุฉ ูุถูููุฉ ูุขููุฉ.</div>
        </div>

        <button class="btn-primary" style="width:100%;justify-content:center;font-size:15px;padding:18px" onclick="placeOrder()">
          โ ุชุฃููุฏ ุงูุทูุจ
        </button>
        <p style="font-size:11px;color:var(--text-muted);text-align:center;margin-top:12px">
          ุจุงูุถุบุท ุนูู ุชุฃููุฏ ุงูุทูุจุ ุฃูุช ุชูุงูู ุนูู ุงูุดุฑูุท ูุงูุฃุญูุงู
        </p>
      </div>
    </div>
  </div>
</section>

<!-- SUCCESS MODAL -->
<div class="modal-overlay" id="success-modal">
  <div class="modal" style="text-align:center;padding:60px 40px;max-width:500px">
    <div style="font-size:64px;margin-bottom:20px">๐ฐ๐ผ๐</div>
    <h2 style="font-family:'Cormorant Garamond',serif;font-size:36px;margin-bottom:12px">ุชู ุงุณุชูุงู ุทูุจู!</h2>
    <p style="color:var(--text-secondary);margin-bottom:8px;font-size:18px">ุฑูู ุทูุจู: <strong style="color:var(--orange)" id="order-number"></strong></p>
    <p style="color:var(--text-muted);font-size:14px;margin-bottom:32px">ุณูุชูุงุตู ูุนู ุงูููุฏูุจ ุฎูุงู 24 ุณุงุนุฉ ูุชุฃููุฏ ููุนุฏ ุงูุชูุตูู ูู ุงููููุช</p>
    
    <div style="background:var(--orange-glow);border:1px solid var(--border);border-radius:10px;padding:20px;margin-bottom:32px;font-size:14px;color:var(--text-secondary)">
      ๐ต ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู - ุงุฏูุน ููููุฏูุจ (ุฏููุงุฑ ูููุชู) ุนูุฏ ุงุณุชูุงู ุนุทูุฑู
    </div>
    
    <!-- ุฑุณุงูุฉ ุงูุชุญููู -->
    <div class="redirect-message" id="redirect-message">
      ุฌุงุฑู ุชุญูููู ุฅูู ุตูุญุฉ ุชุชุจุน ุงูุทูุจ...
    </div>
    
    <!-- ุดุฑูุท ุงูุชูุฏู -->
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
    
    <!-- ุฒุฑ ููุชุญููู ุงููุจุงุดุฑ (ุงุฎุชูุงุฑู) -->
    <a href="order-tracking.html" class="btn-outline" style="display:inline-block;margin-top:20px" id="manual-link">
      ุงูุฐูุงุจ ุฅูู ุชุชุจุน ุงูุทูุจ ุงูุขู โ
    </a>
  </div>
</div>

<footer>
  <div class="container">
    <div class="footer-bottom">
      <p class="footer-copy">ยฉ 2025 ุนุทูุฑ ุงูุฎุจูุฑ - ุงููููุช.</p>
    </div>
  </div>
</footer>

<script src="main.js"></script>
<script>
function renderOrderSummary() {
  const el = document.getElementById('order-items');
  if (!cart.length) { el.innerHTML = '<p style="color:var(--text-muted);text-align:center;font-size:13px">ุณูุชู ูุงุฑุบุฉ</p>'; return; }
  
  el.innerHTML = cart.map(item => `
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px">
      <img src="${item.img}" style="width:50px;height:50px;border-radius:6px;object-fit:cover" alt="${item.name}">
      <div style="flex:1">
        <div style="font-size:13px;font-weight:600">${item.name}</div>
        <div style="font-size:11px;color:var(--text-muted)">${item.size} ร ${item.qty}</div>
      </div>
      <div style="font-size:14px;font-weight:700;color:var(--orange)">${(item.price * item.qty).toFixed(3)} ุฏ.ู</div>
    </div>
  `).join('');

  const subtotal = getCartTotal();
  const shipping = subtotal >= 40 ? 0 : 2.500;
  const tax = 0; // No tax in Kuwait
  const total = subtotal + shipping + tax;
  
  document.getElementById('summary-subtotal').textContent = subtotal.toFixed(3) + ' ุฏ.ู';
  document.getElementById('summary-shipping').textContent = shipping === 0 ? 'ูุฌุงูู ๐' : shipping.toFixed(3) + ' ุฏ.ู';
  document.getElementById('summary-tax').textContent = '0 ุฏ.ู';
  document.getElementById('summary-total').textContent = total.toFixed(3) + ' ุฏ.ู';
}

function placeOrder() {
  const required = ['first-name', 'last-name', 'phone', 'city', 'district', 'street'];
  const missing = required.filter(id => !document.getElementById(id).value.trim());
  if (missing.length) {
    showToast('ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ', 'error');
    document.getElementById(missing[0]).focus();
    return;
  }

  if (!cart.length) { showToast('ุณูุชู ูุงุฑุบุฉ!', 'error'); return; }

  const orderNum = 'KWT-' + Date.now().toString().slice(-6);
  
  // Save order
  const orders = JSON.parse(localStorage.getItem('admin_orders') || '[]');
  const subtotal = getCartTotal();
  const shipping = subtotal >= 40 ? 0 : 2.500;
  const total = subtotal + shipping;
  
  // ุญูุธ ุงูุทูุจ ูู localStorage
  const newOrder = {
    id: orderNum,
    customer: document.getElementById('first-name').value + ' ' + document.getElementById('last-name').value,
    firstName: document.getElementById('first-name').value,
    lastName: document.getElementById('last-name').value,
    phone: '+965' + document.getElementById('phone').value,
    email: document.getElementById('email').value,
    city: document.getElementById('city').value,
    district: document.getElementById('district').value,
    street: document.getElementById('street').value,
    postal: document.getElementById('postal').value,
    deliveryTime: document.getElementById('delivery-time').value,
    notes: document.getElementById('notes').value,
    subtotal: subtotal.toFixed(3),
    shipping: shipping.toFixed(3),
    total: total.toFixed(3),
    status: 'pending',
    date: new Date().toISOString().split('T')[0],
    items: cart.map(i => ({
      name: i.name,
      size: i.size,
      qty: i.qty,
      price: i.price
    }))
  };
  
  orders.unshift(newOrder);
  localStorage.setItem('admin_orders', JSON.stringify(orders));
  
  // ุญูุธ ุขุฎุฑ ุทูุจ ูููุณุชุฎุฏู (ูุตูุญุฉ ุงูุชุชุจุน)
  localStorage.setItem('last_order', JSON.stringify(newOrder));

  // Clear cart
  cart = [];
  saveCart();

  // Show success modal
  document.getElementById('order-number').textContent = orderNum;
  document.getElementById('success-modal').classList.add('open');
  
  // ุชุดุบูู ุดุฑูุท ุงูุชูุฏู
  const progressFill = document.getElementById('progress-fill');
  progressFill.style.width = '100%';
  
  // ุชุญููู ุงููุณุชุฎุฏู ุจุนุฏ 5 ุซูุงูู
  setTimeout(() => {
    window.location.href = 'order-tracking.html?order=' + orderNum;
  }, 5000);
  
  // ุชุญุฏูุซ ุฑุณุงูุฉ ุงูุชุญููู ูู ุซุงููุฉ
  let secondsLeft = 5;
  const redirectMsg = document.getElementById('redirect-message');
  const interval = setInterval(() => {
    secondsLeft--;
    if (secondsLeft > 0) {
      redirectMsg.textContent = `ุฌุงุฑู ุชุญูููู ุฅูู ุตูุญุฉ ุชุชุจุน ุงูุทูุจ ุฎูุงู ${secondsLeft} ุซูุงูู...`;
    } else {
      clearInterval(interval);
    }
  }, 1000);
}

renderOrderSummary();
</script>
</body>
</html>
