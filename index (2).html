<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gift Star - Ù…ØªØ¬Ø± Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ÙƒÙˆÙŠØªÙŠ</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<style>
* { box-sizing:border-box; margin:0; padding:0; }
:root {
  --gold:#c8a96e; --gold-light:#e2c98a; --gold-dark:#a68840;
  --bg:#0f0f1a; --bg2:#161625; --bg3:#1e1e32;
  --border:rgba(200,169,110,0.15); --border2:rgba(200,169,110,0.3);
  --text:#e8e0d0; --muted:#8a7f6e; --success:#5ec98a; --danger:#e05555;
}
html, body { background:var(--bg); font-family:'Tajawal',sans-serif; color:var(--text); direction:rtl; }
img { max-width:100%; }
a { text-decoration:none; color:inherit; }
input, select, textarea, button { font-family:'Tajawal',sans-serif; }
.btn-gold {
  background:linear-gradient(135deg,var(--gold),var(--gold-light));
  color:#0f0f1a; border:none; padding:12px 28px; border-radius:30px;
  font-size:15px; font-weight:800; cursor:pointer; transition:all .2s;
}
.btn-gold:hover { transform:translateY(-2px); box-shadow:0 8px 25px rgba(200,169,110,.4); }
.btn-gold:disabled { opacity:.6; cursor:not-allowed; transform:none; }
.btn-outline {
  background:transparent; color:var(--gold); border:2px solid var(--gold);
  padding:10px 24px; border-radius:30px; font-size:14px; font-weight:700;
  cursor:pointer; transition:all .2s;
}
.btn-outline:hover { background:var(--gold); color:#0f0f1a; }
.container { max-width:1200px; margin:0 auto; padding:0 20px; }
.input-field {
  width:100%; padding:13px 16px; background:var(--bg3); border:1.5px solid var(--border);
  border-radius:10px; color:var(--text); font-size:15px;
  transition:border .2s; outline:none;
}
.input-field:focus { border-color:var(--gold); }
.card {
  background:var(--bg2); border:1px solid var(--border); border-radius:16px;
  transition:all .2s;
}
.card:hover { border-color:var(--border2); box-shadow:0 8px 30px rgba(0,0,0,.3); }
.badge {
  display:inline-block; padding:4px 12px; border-radius:20px; font-size:12px; font-weight:700;
  background:linear-gradient(135deg,var(--gold),var(--gold-light)); color:#0f0f1a;
}
.page-title {
  font-size:clamp(28px,5vw,48px); font-weight:900;
  background:linear-gradient(135deg,var(--gold),var(--gold-light));
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
}
@keyframes fadeIn { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:none} }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.5} }
@keyframes slideUp { from{transform:translateY(40px);opacity:0} to{transform:none;opacity:1} }
.animate-in { animation:fadeIn .4s ease forwards; }
.grid-products { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:24px; }
.grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
.grid-3 { display:grid; grid-template-columns:repeat(3,1fr); gap:20px; }
.grid-4 { display:grid; grid-template-columns:repeat(4,1fr); gap:20px; }
.toast {
  position:fixed; bottom:24px; left:50%; transform:translateX(-50%);
  padding:14px 28px; border-radius:30px; font-weight:700; font-size:15px;
  z-index:9999; animation:slideUp .3s ease; box-shadow:0 8px 30px rgba(0,0,0,.4);
  white-space:nowrap; pointer-events:none;
}
.admin-sidebar-btn {
  display:block; width:100%; padding:10px 14px; margin-bottom:6px; text-align:right;
  background:transparent; border:1px solid transparent; border-radius:10px;
  color:var(--muted); cursor:pointer; font-size:14px; font-weight:400;
  transition:all .15s; position:relative;
}
.admin-sidebar-btn.active {
  background:rgba(200,169,110,.15); border-color:var(--border2); color:var(--gold); font-weight:800;
}
@media(max-width:768px) {
  .grid-2,.grid-3,.grid-4 { grid-template-columns:1fr !important; }
  .grid-products { grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:14px; }
  .admin-layout { grid-template-columns:1fr !important; }
  .admin-sidebar { display:flex; overflow-x:auto; gap:6px; }
  .admin-sidebar-btn { white-space:nowrap; width:auto; }
  .product-detail-grid { grid-template-columns:1fr !important; }
  .checkout-grid { grid-template-columns:1fr !important; }
  .cart-grid { grid-template-columns:1fr !important; }
  .notif-dropdown { width:290px !important; }
}
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

// =====================
// LOCAL STORAGE (GitHub Pages compatible)
// =====================
const ls = {
  get: (key, fallback) => {
    try {
      const v = localStorage.getItem('gs:' + key);
      return v !== null ? JSON.parse(v) : fallback;
    } catch { return fallback; }
  },
  set: (key, value) => {
    try { localStorage.setItem('gs:' + key, JSON.stringify(value)); } catch {}
  }
};

// Session storage for current user
const session = {
  getUser: () => { try { return JSON.parse(sessionStorage.getItem('gs:user')); } catch { return null; } },
  setUser: (u) => { try { sessionStorage.setItem('gs:user', JSON.stringify(u)); } catch {} },
  clearUser: () => { try { sessionStorage.removeItem('gs:user'); } catch {} }
};

// =====================
// INITIAL DATA
// =====================
const INITIAL_PRODUCTS = [
  { id:1, name:"ÙƒÙŠÙƒ Ø§Ù„ÙØ±Ø§ÙˆÙ„Ø© Ø§Ù„ÙØ§Ø®Ø±", cat:"cakes", price:12.500, img:"https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=400&h=400&fit=crop", desc:"ÙƒÙŠÙƒ ÙØ±Ø§ÙˆÙ„Ø© Ø·Ø§Ø²Ø¬Ø© Ø¨ÙƒØ±ÙŠÙ…Ø© Ø§Ù„Ø´Ø§Ù†ØªÙŠÙ‡ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©", badge:"Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹", stock:20, featured:true },
  { id:2, name:"Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯ Ø­Ù…Ø±Ø§Ø¡", cat:"flowers", price:8.750, img:"https://images.unsplash.com/photo-1518621736915-f3b1c41bfd00?w=400&h=400&fit=crop", desc:"24 ÙˆØ±Ø¯Ø© Ø­Ù…Ø±Ø§Ø¡ Ø·Ø§Ø²Ø¬Ø© Ù…Ø¹ ÙˆØ±Ù‚ Ø§Ù„Ø²ÙŠÙ†Ø©", badge:"Ø¬Ø¯ÙŠØ¯", stock:30, featured:true },
  { id:3, name:"ØªÙˆØ±ØªØ© Ø§Ù„Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©", cat:"cakes", price:15.000, img:"https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&h=400&fit=crop", desc:"ØªÙˆØ±ØªØ© Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ© Ø¨Ù„Ø¬ÙŠÙƒÙŠØ© ÙØ§Ø®Ø±Ø© Ø¨Ø·Ø¨Ù‚Ø§Øª Ø§Ù„ÙƒØ±ÙŠÙ…Ø©", badge:"", stock:15, featured:true },
  { id:4, name:"Ø¨Ø§Ù‚Ø© Ø²Ù‡ÙˆØ± Ø§Ù„Ø±Ø¨ÙŠØ¹", cat:"flowers", price:11.000, img:"https://images.unsplash.com/photo-1490750967868-88df5691cc95?w=400&h=400&fit=crop", desc:"ØªØ´ÙƒÙŠÙ„Ø© Ù…Ù† Ø£Ø¬Ù…Ù„ Ø²Ù‡ÙˆØ± Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø§Ù„Ù…Ù„ÙˆÙ†Ø©", badge:"", stock:25, featured:false },
  { id:5, name:"Ø¹Ù„Ø¨Ø© Ù‡Ø¯Ø§ÙŠØ§ ÙØ§Ø®Ø±Ø©", cat:"gifts", price:22.000, img:"https://images.unsplash.com/photo-1513885535751-8b9238bd345a?w=400&h=400&fit=crop", desc:"Ø¹Ù„Ø¨Ø© Ù‡Ø¯Ø§ÙŠØ§ Ù…Ù…ÙŠØ²Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØ´ÙƒÙŠÙ„Ø© Ù…Ù† Ø§Ù„Ø­Ù„ÙˆÙŠØ§Øª ÙˆØ§Ù„Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©", badge:"Ù…Ù…ÙŠØ²", stock:10, featured:true },
  { id:6, name:"Ø¨Ø§Ù„ÙˆÙ† ØªØ²ÙŠÙŠÙ†", cat:"gifts", price:5.500, img:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=400&h=400&fit=crop", desc:"Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨Ø§Ù„ÙˆÙ†Ø§Øª Ù…Ù„ÙˆÙ†Ø© Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ø³Ø¹ÙŠØ¯Ø©", badge:"", stock:50, featured:false },
  { id:7, name:"ÙƒÙŠÙƒ Ø¹ÙŠØ¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯", cat:"cakes", price:18.000, img:"https://images.unsplash.com/photo-1558636508-e0db3814bd1d?w=400&h=400&fit=crop", desc:"ÙƒÙŠÙƒ Ø§Ø­ØªÙØ§Ù„ÙŠ Ù…Ø¹ Ø´Ù…Ø¹Ø§Øª ÙˆØ²ÙŠÙ†Ø© Ù…Ù…ÙŠØ²Ø©", badge:"Ø¹Ø±Ø¶", stock:12, featured:true },
  { id:8, name:"ÙˆØ±Ø¯ Ø£Ø¨ÙŠØ¶ ÙØ§Ø®Ø±", cat:"flowers", price:14.500, img:"https://images.unsplash.com/photo-1487530811015-780aa15174b8?w=400&h=400&fit=crop", desc:"30 ÙˆØ±Ø¯Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ø·Ø§Ø²Ø¬Ø© ÙÙŠ ØªØºÙ„ÙŠÙ ÙØ§Ø®Ø±", badge:"", stock:20, featured:false },
];
const INITIAL_USERS = [
  { id:1, name:"Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ØªØ¬Ø±", email:"admin@giftstar.kw", password:"Admin@2024", role:"admin", phone:"51234567" },
  { id:2, name:"Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯", email:"ahmed@test.com", password:"12345678", role:"customer", phone:"51234568" },
];
const INITIAL_ANN = [{ id:1, text:"âœ¨ ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª ÙÙˆÙ‚ 15 Ø¯.Ùƒ Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙˆÙŠØª", active:true, color:"gold" }];

const STATUS_MAP = { new:"Ø¬Ø¯ÙŠØ¯", processing:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©", delivered:"ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„", cancelled:"Ù…Ù„ØºÙŠ" };
const STATUS_COLOR = { new:"#5ec98a", processing:"#f39c12", delivered:"#3498db", cancelled:"#e05555" };
const AREAS = ["Ø§Ù„Ø¹Ø§ØµÙ…Ø©","Ø­ÙˆÙ„ÙŠ","Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©","Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„ÙƒØ¨ÙŠØ±","Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ","Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡"];
const ANN_COLORS = {
  gold:  { bg:"linear-gradient(90deg,#a68840,#c8a96e)", color:"#0f0f1a" },
  red:   { bg:"linear-gradient(90deg,#c0392b,#e74c3c)", color:"#fff" },
  green: { bg:"linear-gradient(90deg,#27ae60,#2ecc71)", color:"#fff" },
  blue:  { bg:"linear-gradient(90deg,#2980b9,#3498db)", color:"#fff" },
  dark:  { bg:"linear-gradient(90deg,#1a1a2e,#2d2d4e)", color:"var(--gold)" },
};

const kwd = (n) => Number(n||0).toFixed(3) + " Ø¯.Ùƒ";
const genId = () => "GS-" + Date.now().toString(36).toUpperCase().slice(-6);

// =====================
// APP
// =====================
function App() {
  const [page, setPage] = useState("home");
  const [products, setProducts] = useState(() => {
    const p = ls.get("products", null);
    return p && p.length ? p : INITIAL_PRODUCTS;
  });
  const [users, setUsers] = useState(() => {
    const u = ls.get("users", null);
    return u && u.length ? u : INITIAL_USERS;
  });
  const [orders, setOrders] = useState(() => ls.get("orders", []));
  const [cart, setCart] = useState([]);
  const [currentUser, setCurrentUser] = useState(() => session.getUser());
  const [notifications, setNotifications] = useState(() => ls.get("notifications", []));
  const [unreadCount, setUnreadCount] = useState(() => ls.get("unread", 0));
  const [announcements, setAnnouncements] = useState(() => {
    const a = ls.get("announcements", null);
    return a !== null ? a : INITIAL_ANN;
  });
  const [toast, setToast] = useState(null);
  const [selectedOrder, setSelectedOrder] = useState(null);
  const [adminTab, setAdminTab] = useState("dashboard");
  const prevOrdersLen = useRef(orders.length);
  const toastTimer = useRef(null);

  // Poll for new orders every 4 seconds (admin real-time)
  useEffect(() => {
    if (!currentUser || currentUser.role !== "admin") return;
    const interval = setInterval(() => {
      const fresh = ls.get("orders", []);
      if (fresh.length > prevOrdersLen.current) {
        const newOrds = fresh.slice(prevOrdersLen.current);
        setOrders(fresh);
        prevOrdersLen.current = fresh.length;
        const freshN = ls.get("notifications", []);
        setNotifications(freshN);
        setUnreadCount(ls.get("unread", 0));
        newOrds.forEach(o => showToast(`ğŸ›’ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ${o.customerName} â€” ${kwd(o.total)}`, "success"));
      }
    }, 4000);
    return () => clearInterval(interval);
  }, [currentUser]);

  const showToast = (msg, type = "success") => {
    if (toastTimer.current) clearTimeout(toastTimer.current);
    setToast({ msg, type });
    toastTimer.current = setTimeout(() => setToast(null), 4000);
  };

  const saveProducts = (p) => { setProducts(p); ls.set("products", p); };
  const saveOrders = (o) => { setOrders(o); ls.set("orders", o); };
  const saveUsers = (u) => { setUsers(u); ls.set("users", u); };
  const saveAnnouncements = (a) => { setAnnouncements(a); ls.set("announcements", a); };

  const addNotification = (text, orderId) => {
    const n = ls.get("notifications", []);
    const newN = [{ id: Date.now(), text, orderId, time: new Date().toISOString(), read: false }, ...n];
    ls.set("notifications", newN);
    setNotifications(newN);
    const uc = ls.get("unread", 0) + 1;
    ls.set("unread", uc);
    setUnreadCount(uc);
  };

  const markAllRead = () => {
    const newN = notifications.map(n => ({ ...n, read: true }));
    setNotifications(newN);
    ls.set("notifications", newN);
    ls.set("unread", 0);
    setUnreadCount(0);
  };

  const placeOrder = (orderData) => {
    const order = {
      id: genId(), ...orderData, status: "new",
      date: new Date().toLocaleDateString("ar-KW"),
      time: new Date().toLocaleTimeString("ar-KW", { hour:"2-digit", minute:"2-digit" }),
      createdAt: new Date().toISOString(),
    };
    const newOrders = [order, ...orders];
    saveOrders(newOrders);
    prevOrdersLen.current = newOrders.length;
    addNotification(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ #${order.id} Ù…Ù† ${order.customerName} Ø¨Ù‚ÙŠÙ…Ø© ${kwd(order.total)}`, order.id);
    setCart([]);
    showToast("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!");
    return order;
  };

  const login = (email, password) => {
    const u = users.find(u => u.email === email && u.password === password);
    if (u) { setCurrentUser(u); session.setUser(u); return { success: true, user: u }; }
    return { success: false, error: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©" };
  };

  const register = (name, email, password, phone) => {
    if (users.find(u => u.email === email)) return { success: false, error: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹" };
    const newUser = { id: Date.now(), name, email, password, role: "customer", phone };
    saveUsers([...users, newUser]);
    setCurrentUser(newUser); session.setUser(newUser);
    return { success: true };
  };

  const logout = () => { setCurrentUser(null); session.clearUser(); setCart([]); setPage("home"); };

  const addToCart = (product) => {
    if (!currentUser) { setPage("login"); return; }
    setCart(prev => {
      const ex = prev.find(i => i.id === product.id);
      if (ex) return prev.map(i => i.id === product.id ? { ...i, qty: i.qty + 1 } : i);
      return [...prev, { ...product, qty: 1 }];
    });
    showToast("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›ï¸");
  };

  const updateOrderStatus = (orderId, status) => {
    const newOrders = orders.map(o => o.id === orderId ? { ...o, status } : o);
    saveOrders(newOrders);
    showToast(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰: ${STATUS_MAP[status]}`);
  };

  const cartCount = cart.reduce((s, i) => s + i.qty, 0);
  const cartTotal = cart.reduce((s, i) => s + i.price * i.qty, 0);
  const isAdmin = currentUser?.role === "admin";

  const p = {
    page, setPage, products, users, orders, cart, setCart, currentUser, notifications, unreadCount,
    announcements, addToCart, placeOrder, login, register, logout, updateOrderStatus,
    saveProducts, saveOrders, saveUsers, saveAnnouncements,
    markAllRead, cartCount, cartTotal, isAdmin, selectedOrder, setSelectedOrder,
    adminTab, setAdminTab, showToast
  };

  return (
    <div style={{ minHeight:"100vh", background:"var(--bg)", color:"var(--text)" }}>
      <Header {...p} />
      <main>
        {page === "home"     && <HomePage {...p} />}
        {page === "shop"     && <ShopPage {...p} />}
        {page.startsWith("product:") && <ProductPage {...p} />}
        {page === "cart"     && <CartPage {...p} />}
        {page === "checkout" && <CheckoutPage {...p} />}
        {page === "receipt"  && <ReceiptPage {...p} />}
        {page === "orders"   && <MyOrdersPage {...p} />}
        {page === "login"    && <LoginPage {...p} />}
        {page === "register" && <RegisterPage {...p} />}
        {page === "admin" && isAdmin && <AdminPage {...p} />}
      </main>
      {toast && (
        <div className="toast" style={{ background: toast.type === "success" ? "rgba(94,201,138,.95)" : "rgba(224,85,85,.95)", color:"#fff" }}>
          {toast.msg}
        </div>
      )}
    </div>
  );
}

// =====================
// HEADER
// =====================
function Header({ page, setPage, cartCount, currentUser, notifications, unreadCount, markAllRead, isAdmin, logout, announcements }) {
  const [showNotifs, setShowNotifs] = useState(false);
  const [showMenu, setShowMenu] = useState(false);
  const [annIdx, setAnnIdx] = useState(0);
  const activeAnns = (announcements || []).filter(a => a.active);

  useEffect(() => {
    if (activeAnns.length <= 1) return;
    const t = setInterval(() => setAnnIdx(i => (i + 1) % activeAnns.length), 4000);
    return () => clearInterval(t);
  }, [activeAnns.length]);

  const ann = activeAnns[annIdx] || null;
  const annStyle = ann ? (ANN_COLORS[ann.color] || ANN_COLORS.gold) : null;

  return (
    <header style={{ background:"rgba(15,15,26,.97)", backdropFilter:"blur(20px)", borderBottom:"1px solid var(--border)", position:"sticky", top:0, zIndex:100 }}>
      {ann && (
        <div style={{ background:annStyle.bg, padding:"7px 16px", textAlign:"center", fontSize:13, fontWeight:600, color:annStyle.color, position:"relative" }}>
          {ann.text}
          {activeAnns.length > 1 && (
            <span style={{ position:"absolute", left:14, top:"50%", transform:"translateY(-50%)", display:"flex", gap:4 }}>
              {activeAnns.map((_,i) => (
                <span key={i} onClick={() => setAnnIdx(i)}
                  style={{ width:6, height:6, borderRadius:"50%", background:i===annIdx?"rgba(0,0,0,.6)":"rgba(0,0,0,.25)", cursor:"pointer", display:"inline-block" }} />
              ))}
            </span>
          )}
        </div>
      )}
      <div className="container" style={{ display:"flex", alignItems:"center", justifyContent:"space-between", padding:"14px 20px", gap:12 }}>
        {/* Logo */}
        <button onClick={() => setPage("home")} style={{ background:"none", border:"none", cursor:"pointer", display:"flex", alignItems:"center", gap:8, flexShrink:0 }}>
          <span style={{ fontSize:26, color:"var(--gold)" }}>â˜…</span>
          <span style={{ fontSize:20, fontWeight:900, background:"linear-gradient(135deg,var(--gold),var(--gold-light))", WebkitBackgroundClip:"text", WebkitTextFillColor:"transparent" }}>Gift Star</span>
        </button>

        {/* Nav */}
        <nav style={{ display:"flex", alignItems:"center", gap:20, flexWrap:"wrap" }}>
          {[["home","Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"],["shop","Ø§Ù„Ù…ØªØ¬Ø±"]].map(([pg,lbl]) => (
            <button key={pg} onClick={() => setPage(pg)} style={{
              background:"none", border:"none", cursor:"pointer", fontSize:14, fontWeight:600,
              color: page===pg ? "var(--gold)" : "var(--muted)",
              borderBottom: page===pg ? "2px solid var(--gold)" : "2px solid transparent", paddingBottom:2
            }}>{lbl}</button>
          ))}
          {currentUser && (
            <button onClick={() => setPage("orders")} style={{
              background:"none", border:"none", cursor:"pointer", fontSize:14, fontWeight:600,
              color: page==="orders" ? "var(--gold)" : "var(--muted)"
            }}>Ø·Ù„Ø¨Ø§ØªÙŠ</button>
          )}
          {isAdmin && (
            <button onClick={() => setPage("admin")} style={{
              background:"linear-gradient(135deg,var(--gold),var(--gold-light))",
              border:"none", cursor:"pointer", fontSize:13, fontWeight:800, color:"#0f0f1a",
              padding:"5px 14px", borderRadius:18
            }}>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
          )}
        </nav>

        {/* Actions */}
        <div style={{ display:"flex", alignItems:"center", gap:12, flexShrink:0 }}>
          {/* Cart */}
          <button onClick={() => setPage("cart")} style={{ background:"none", border:"none", cursor:"pointer", position:"relative" }}>
            <svg width={22} height={22} viewBox="0 0 24 24" fill="none" stroke="var(--gold)" strokeWidth={2}>
              <circle cx={9} cy={21} r={1}/><circle cx={20} cy={21} r={1}/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
            {cartCount > 0 && (
              <span style={{ position:"absolute", top:-6, right:-6, background:"var(--gold)", color:"#0f0f1a", borderRadius:"50%", width:18, height:18, fontSize:11, fontWeight:900, display:"flex", alignItems:"center", justifyContent:"center" }}>
                {cartCount}
              </span>
            )}
          </button>

          {/* Notifications (admin) */}
          {isAdmin && (
            <div style={{ position:"relative" }}>
              <button onClick={() => { setShowNotifs(!showNotifs); if (!showNotifs) markAllRead(); }}
                style={{ background:"none", border:"none", cursor:"pointer", position:"relative" }}>
                <svg width={22} height={22} viewBox="0 0 24 24" fill="none" stroke="var(--gold)" strokeWidth={2}>
                  <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                </svg>
                {unreadCount > 0 && (
                  <span style={{ position:"absolute", top:-5, right:-5, background:"var(--danger)", color:"#fff", borderRadius:"50%", width:18, height:18, fontSize:10, fontWeight:900, display:"flex", alignItems:"center", justifyContent:"center", animation:"pulse 1.5s infinite" }}>
                    {unreadCount > 9 ? "9+" : unreadCount}
                  </span>
                )}
              </button>
              {showNotifs && (
                <div className="notif-dropdown" style={{ position:"absolute", left:0, top:"115%", background:"var(--bg2)", border:"1px solid var(--border)", borderRadius:14, width:330, maxHeight:380, overflowY:"auto", boxShadow:"0 12px 40px rgba(0,0,0,.5)", zIndex:200 }}>
                  <div style={{ padding:"12px 16px", borderBottom:"1px solid var(--border)", fontWeight:800, color:"var(--gold)", fontSize:14 }}>ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
                  {!notifications.length ? (
                    <div style={{ padding:30, textAlign:"center", color:"var(--muted)", fontSize:14 }}>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
                  ) : notifications.map(n => (
                    <div key={n.id} style={{ padding:"12px 16px", borderBottom:"1px solid var(--border)", background:n.read?"transparent":"rgba(200,169,110,.05)", display:"flex", gap:10 }}>
                      <span style={{ fontSize:18 }}>ğŸ›’</span>
                      <div style={{ flex:1 }}>
                        <div style={{ fontSize:13, lineHeight:1.5 }}>{n.text}</div>
                        <div style={{ fontSize:11, color:"var(--muted)", marginTop:3 }}>{new Date(n.time).toLocaleString("ar-KW")}</div>
                      </div>
                      {!n.read && <div style={{ width:8, height:8, borderRadius:"50%", background:"var(--gold)", flexShrink:0, marginTop:4 }} />}
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          {/* User menu */}
          {currentUser ? (
            <div style={{ position:"relative" }}>
              <button onClick={() => setShowMenu(!showMenu)} style={{
                background:"var(--bg3)", border:"1px solid var(--border)", borderRadius:24,
                padding:"6px 14px", cursor:"pointer", display:"flex", alignItems:"center", gap:8, color:"var(--text)", fontSize:14
              }}>
                <span style={{ color:"var(--gold)" }}>ğŸ‘¤</span>{currentUser.name.split(" ")[0]}
              </button>
              {showMenu && (
                <div style={{ position:"absolute", left:0, top:"115%", background:"var(--bg2)", border:"1px solid var(--border)", borderRadius:12, minWidth:160, overflow:"hidden", boxShadow:"0 8px 30px rgba(0,0,0,.4)", zIndex:200 }}>
                  <button onClick={() => { setPage("orders"); setShowMenu(false); }} style={{ display:"block", width:"100%", padding:"12px 16px", background:"none", border:"none", color:"var(--text)", cursor:"pointer", textAlign:"right", fontSize:14 }}>ğŸ“¦ Ø·Ù„Ø¨Ø§ØªÙŠ</button>
                  <button onClick={() => { logout(); setShowMenu(false); }} style={{ display:"block", width:"100%", padding:"12px 16px", background:"none", border:"none", color:"var(--danger)", cursor:"pointer", textAlign:"right", fontSize:14 }}>ğŸšª Ø®Ø±ÙˆØ¬</button>
                </div>
              )}
            </div>
          ) : (
            <button onClick={() => setPage("login")} className="btn-gold" style={{ padding:"8px 18px", fontSize:13 }}>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
          )}
        </div>
      </div>
    </header>
  );
}

// =====================
// HOME PAGE
// =====================
function HomePage({ setPage, products, addToCart }) {
  const featured = products.filter(p => p.featured).slice(0, 8);
  return (
    <div>
      {/* Hero */}
      <div style={{ background:"linear-gradient(135deg,#0f0f1a 0%,#1a1a2e 50%,#1e1a0e 100%)", padding:"80px 20px", textAlign:"center", position:"relative", overflow:"hidden" }}>
        <div style={{ position:"absolute", inset:0, background:"radial-gradient(circle at 50% 50%, rgba(200,169,110,.08) 0%, transparent 60%)", pointerEvents:"none" }} />
        <div style={{ position:"relative", zIndex:1 }}>
          <div style={{ fontSize:56, marginBottom:14 }}>â˜…</div>
          <h1 style={{ marginBottom:18 }}>
            <span className="page-title" style={{ fontSize:"clamp(38px,7vw,70px)", display:"block" }}>Gift Star</span>
            <span style={{ color:"var(--muted)", fontSize:"clamp(18px,3vw,28px)", fontWeight:400 }}>Ù…ØªØ¬Ø± Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ÙƒÙˆÙŠØªÙŠ Ø§Ù„Ø£ÙˆÙ„</span>
          </h1>
          <p style={{ color:"var(--muted)", fontSize:16, marginBottom:34, maxWidth:480, margin:"0 auto 34px" }}>Ø£Ø¬Ù…Ù„ Ø§Ù„ÙƒÙŠÙƒ ÙˆØ§Ù„ÙˆØ±Ø¯ ÙˆØ§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ù„ÙƒÙ„ Ù…Ù†Ø§Ø³Ø¨Ø§ØªÙƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</p>
          <button className="btn-gold" onClick={() => setPage("shop")} style={{ padding:"14px 36px", fontSize:17 }}>ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù† ğŸ›ï¸</button>
        </div>
      </div>

      {/* Categories */}
      <div className="container" style={{ padding:"60px 20px" }}>
        <h2 className="page-title" style={{ textAlign:"center", marginBottom:32 }}>ØªØ³ÙˆÙ‚ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©</h2>
        <div className="grid-3">
          {[
            { key:"cakes", label:"ÙƒÙŠÙƒ ğŸ‚", img:"https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&h=200&fit=crop" },
            { key:"flowers", label:"ÙˆØ±Ø¯ ğŸŒ¹", img:"https://images.unsplash.com/photo-1490750967868-88df5691cc95?w=400&h=200&fit=crop" },
            { key:"gifts", label:"Ù‡Ø¯Ø§ÙŠØ§ ğŸ", img:"https://images.unsplash.com/photo-1513885535751-8b9238bd345a?w=400&h=200&fit=crop" },
          ].map(c => (
            <div key={c.key} className="card" onClick={() => setPage("shop:" + c.key)} style={{ cursor:"pointer", overflow:"hidden" }}>
              <img src={c.img} alt={c.label} style={{ width:"100%", height:140, objectFit:"cover" }} />
              <div style={{ padding:16, textAlign:"center", fontSize:17, fontWeight:800 }}>{c.label}</div>
            </div>
          ))}
        </div>
      </div>

      {/* Featured */}
      <div style={{ background:"var(--bg2)", padding:"60px 0" }}>
        <div className="container">
          <h2 className="page-title" style={{ textAlign:"center", marginBottom:32 }}>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
          <div className="grid-products">
            {featured.map(p => <ProductCard key={p.id} product={p} onAdd={addToCart} setPage={setPage} />)}
          </div>
          <div style={{ textAlign:"center", marginTop:32 }}>
            <button className="btn-outline" onClick={() => setPage("shop")}>Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
          </div>
        </div>
      </div>

      {/* Why us */}
      <div className="container" style={{ padding:"60px 20px" }}>
        <h2 className="page-title" style={{ textAlign:"center", marginBottom:32 }}>Ù„Ù…Ø§Ø°Ø§ Gift StarØŸ</h2>
        <div className="grid-4">
          {[
            { icon:"ğŸ›¡ï¸", title:"Ø¬ÙˆØ¯Ø© Ù…Ø¶Ù…ÙˆÙ†Ø©", desc:"Ù…Ù†ØªØ¬Ø§Øª Ø·Ø§Ø²Ø¬Ø© Ù…Ø®ØªØ§Ø±Ø© Ø¨Ø¹Ù†Ø§ÙŠØ©" },
            { icon:"âš¡", title:"ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹", desc:"ØªÙˆØµÙŠÙ„ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ… Ù„ÙƒÙ„ Ø§Ù„ÙƒÙˆÙŠØª" },
            { icon:"ğŸ’", title:"Ø®Ø¯Ù…Ø© Ø´Ø®ØµÙŠØ©", desc:"Ù†Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‡Ø¯ÙŠØ© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©" },
            { icon:"ğŸ”’", title:"Ø¯ÙØ¹ Ø¢Ù…Ù†", desc:"Ø·Ø±Ù‚ Ø¯ÙØ¹ Ù…ØªØ¹Ø¯Ø¯Ø© ÙˆØ¢Ù…Ù†Ø© 100%" },
          ].map((w, i) => (
            <div key={i} className="card" style={{ padding:22, textAlign:"center" }}>
              <div style={{ fontSize:36, marginBottom:10 }}>{w.icon}</div>
              <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:8, fontSize:15 }}>{w.title}</h3>
              <p style={{ color:"var(--muted)", fontSize:13 }}>{w.desc}</p>
            </div>
          ))}
        </div>
      </div>

      {/* Footer */}
      <footer style={{ background:"var(--bg2)", borderTop:"1px solid var(--border)", padding:"20px 0", textAlign:"center" }}>
        <p style={{ color:"var(--muted)", fontSize:13 }}>Â© 2024 Gift Star. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€” Ø§Ù„ÙƒÙˆÙŠØª</p>
      </footer>
    </div>
  );
}

// =====================
// PRODUCT CARD
// =====================
function ProductCard({ product: p, onAdd, setPage }) {
  const [added, setAdded] = useState(false);
  const handle = (e) => { e.stopPropagation(); onAdd(p); setAdded(true); setTimeout(() => setAdded(false), 1500); };
  return (
    <div className="card animate-in" style={{ overflow:"hidden", cursor:"pointer" }} onClick={() => setPage("product:" + p.id)}>
      <div style={{ position:"relative" }}>
        <img src={p.img} alt={p.name} style={{ width:"100%", height:200, objectFit:"cover" }} onError={e => e.target.src="https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=400&h=200&fit=crop"} />
        {p.badge && <span className="badge" style={{ position:"absolute", top:10, right:10 }}>{p.badge}</span>}
      </div>
      <div style={{ padding:16 }}>
        <h3 style={{ fontWeight:800, marginBottom:6, fontSize:15 }}>{p.name}</h3>
        <p style={{ color:"var(--muted)", fontSize:13, marginBottom:14, lineHeight:1.5 }}>{p.desc.substring(0,55)}...</p>
        <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center" }}>
          <span style={{ color:"var(--gold)", fontWeight:900, fontSize:17 }}>{kwd(p.price)}</span>
          <button className="btn-gold" onClick={handle} style={{ padding:"7px 16px", fontSize:12, background: added ? "linear-gradient(135deg,var(--success),#7fe0a0)" : undefined }}>
            {added ? "âœ“" : "Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©"}
          </button>
        </div>
      </div>
    </div>
  );
}

// =====================
// SHOP PAGE
// =====================
function ShopPage({ page, products, addToCart, setPage }) {
  const initCat = page.includes(":") ? page.split(":")[1] : "all";
  const [cat, setCat] = useState(initCat);
  const [sort, setSort] = useState("default");

  let list = cat === "all" ? products : products.filter(p => p.cat === cat);
  if (sort === "asc") list = [...list].sort((a,b) => a.price - b.price);
  if (sort === "desc") list = [...list].sort((a,b) => b.price - a.price);

  return (
    <div className="container" style={{ padding:"40px 20px" }}>
      <h1 className="page-title" style={{ marginBottom:28 }}>Ø§Ù„Ù…ØªØ¬Ø±</h1>
      <div style={{ display:"flex", gap:12, alignItems:"center", marginBottom:28, flexWrap:"wrap", justifyContent:"space-between" }}>
        <div style={{ display:"flex", gap:8, flexWrap:"wrap" }}>
          {[["all","Ø§Ù„ÙƒÙ„"],["cakes","ÙƒÙŠÙƒ ğŸ‚"],["flowers","ÙˆØ±Ø¯ ğŸŒ¹"],["gifts","Ù‡Ø¯Ø§ÙŠØ§ ğŸ"]].map(([v,l]) => (
            <button key={v} onClick={() => setCat(v)} style={{
              padding:"7px 18px", borderRadius:20, border:"1.5px solid",
              borderColor:cat===v?"var(--gold)":"var(--border)",
              background:cat===v?"var(--gold)":"transparent",
              color:cat===v?"#0f0f1a":"var(--muted)",
              cursor:"pointer", fontWeight:700, fontSize:13
            }}>{l}</button>
          ))}
        </div>
        <select className="input-field" value={sort} onChange={e => setSort(e.target.value)} style={{ width:"auto", padding:"8px 14px" }}>
          <option value="default">Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
          <option value="asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„</option>
          <option value="desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
        </select>
      </div>
      <p style={{ color:"var(--muted)", marginBottom:18, fontSize:13 }}>ğŸ“¦ {list.length} Ù…Ù†ØªØ¬</p>
      <div className="grid-products">
        {list.map(p => <ProductCard key={p.id} product={p} onAdd={addToCart} setPage={setPage} />)}
      </div>
    </div>
  );
}

// =====================
// PRODUCT PAGE
// =====================
function ProductPage({ page, products, addToCart, setPage }) {
  const id = parseInt(page.split(":")[1]);
  const p = products.find(pr => pr.id === id);
  const [qty, setQty] = useState(1);
  const [added, setAdded] = useState(false);

  if (!p) return <div style={{ padding:80, textAlign:"center", color:"var(--muted)" }}>Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</div>;

  const handle = () => {
    for (let i = 0; i < qty; i++) addToCart(p);
    setAdded(true);
    setTimeout(() => { setAdded(false); setPage("cart"); }, 1000);
  };

  return (
    <div className="container" style={{ padding:"40px 20px" }}>
      <button onClick={() => setPage("shop")} style={{ background:"none", border:"none", color:"var(--muted)", cursor:"pointer", marginBottom:24, fontSize:14 }}>â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±</button>
      <div className="product-detail-grid" style={{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:40 }}>
        <img src={p.img} alt={p.name} style={{ width:"100%", borderRadius:16, maxHeight:440, objectFit:"cover" }} onError={e => e.target.src="https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=500&h=440&fit=crop"} />
        <div>
          {p.badge && <span className="badge" style={{ marginBottom:14, display:"inline-block" }}>{p.badge}</span>}
          <h1 style={{ fontSize:30, fontWeight:900, marginBottom:10 }}>{p.name}</h1>
          <div style={{ fontSize:30, color:"var(--gold)", fontWeight:900, marginBottom:18 }}>{kwd(p.price)}</div>
          <p style={{ color:"var(--muted)", lineHeight:1.8, marginBottom:28, fontSize:15 }}>{p.desc}</p>
          <div style={{ display:"flex", alignItems:"center", gap:14, marginBottom:22 }}>
            <button onClick={() => setQty(Math.max(1,qty-1))} style={{ width:38, height:38, borderRadius:"50%", background:"var(--bg3)", border:"1px solid var(--border)", color:"var(--text)", fontSize:20, cursor:"pointer" }}>-</button>
            <span style={{ fontSize:20, fontWeight:800, minWidth:28, textAlign:"center" }}>{qty}</span>
            <button onClick={() => setQty(qty+1)} style={{ width:38, height:38, borderRadius:"50%", background:"var(--bg3)", border:"1px solid var(--border)", color:"var(--text)", fontSize:20, cursor:"pointer" }}>+</button>
            <span style={{ color:"var(--muted)", fontSize:13 }}>Ù…ØªØ§Ø­: {p.stock}</span>
          </div>
          <button className="btn-gold" onClick={handle} style={{ width:"100%", padding:15, fontSize:16, background: added ? "linear-gradient(135deg,var(--success),#7fe0a0)" : undefined }}>
            {added ? "âœ“ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©..." : "Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© ğŸ›’"}
          </button>
        </div>
      </div>
    </div>
  );
}

// =====================
// CART PAGE
// =====================
function CartPage({ cart, setCart, setPage, currentUser }) {
  const sub = cart.reduce((s,i) => s + i.price*i.qty, 0);
  const delivery = sub > 15 ? 0 : 1.500;
  const total = sub + delivery;
  const upd = (id, dir) => setCart(prev => prev.map(i => i.id===id ? {...i, qty:Math.max(1,i.qty+dir)} : i));
  const rem = (id) => setCart(prev => prev.filter(i => i.id !== id));

  if (!cart.length) return (
    <div style={{ textAlign:"center", padding:"100px 20px" }}>
      <div style={{ fontSize:72, marginBottom:18, opacity:.3 }}>ğŸ›’</div>
      <h2 style={{ color:"var(--muted)", marginBottom:16 }}>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</h2>
      <button className="btn-gold" onClick={() => setPage("shop")}>ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†</button>
    </div>
  );

  return (
    <div className="container" style={{ padding:"40px 20px" }}>
      <h1 className="page-title" style={{ marginBottom:28 }}>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h1>
      <div className="cart-grid" style={{ display:"grid", gridTemplateColumns:"1fr 340px", gap:28 }}>
        <div>
          {cart.map(item => (
            <div key={item.id} className="card" style={{ display:"flex", gap:14, padding:18, marginBottom:14 }}>
              <img src={item.img} alt={item.name} style={{ width:88, height:88, borderRadius:10, objectFit:"cover", flexShrink:0 }} onError={e => e.target.src="https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=88&h=88&fit=crop"} />
              <div style={{ flex:1 }}>
                <h3 style={{ marginBottom:8, fontWeight:800, fontSize:15 }}>{item.name}</h3>
                <div style={{ display:"flex", alignItems:"center", gap:10, marginBottom:8 }}>
                  <button onClick={() => upd(item.id,-1)} style={{ width:28, height:28, borderRadius:"50%", background:"var(--bg3)", border:"1px solid var(--border)", cursor:"pointer", color:"var(--text)" }}>-</button>
                  <span style={{ fontWeight:800, minWidth:20, textAlign:"center" }}>{item.qty}</span>
                  <button onClick={() => upd(item.id,+1)} style={{ width:28, height:28, borderRadius:"50%", background:"var(--bg3)", border:"1px solid var(--border)", cursor:"pointer", color:"var(--text)" }}>+</button>
                </div>
                <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center" }}>
                  <span style={{ color:"var(--gold)", fontWeight:900 }}>{kwd(item.price*item.qty)}</span>
                  <button onClick={() => rem(item.id)} style={{ background:"none", border:"none", color:"var(--danger)", cursor:"pointer", fontSize:13 }}>Ø­Ø°Ù âœ•</button>
                </div>
              </div>
            </div>
          ))}
        </div>
        <div>
          <div className="card" style={{ padding:22, position:"sticky", top:80 }}>
            <h3 style={{ fontWeight:800, marginBottom:18, color:"var(--gold)" }}>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h3>
            <div style={{ display:"flex", justifyContent:"space-between", padding:"9px 0", borderBottom:"1px solid var(--border)", color:"var(--muted)", fontSize:14 }}>
              <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</span><span>{kwd(sub)}</span>
            </div>
            <div style={{ display:"flex", justifyContent:"space-between", padding:"9px 0", borderBottom:"1px solid var(--border)", color:"var(--muted)", fontSize:14 }}>
              <span>Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</span>
              <span style={{ color:delivery===0?"var(--success)":undefined }}>{delivery===0?"Ù…Ø¬Ø§Ù†ÙŠ ğŸ‰":kwd(delivery)}</span>
            </div>
            <div style={{ display:"flex", justifyContent:"space-between", padding:"15px 0 0", fontSize:19, fontWeight:900 }}>
              <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span style={{ color:"var(--gold)" }}>{kwd(total)}</span>
            </div>
            <button className="btn-gold" onClick={() => setPage(currentUser ? "checkout" : "login")} style={{ width:"100%", padding:13, fontSize:15, marginTop:18 }}>
              {currentUser ? "Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ø¯ÙØ¹ â†’" : "Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©"}
            </button>
            <button className="btn-outline" onClick={() => setPage("shop")} style={{ width:"100%", marginTop:10, padding:11 }}>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ³ÙˆÙ‚</button>
          </div>
        </div>
      </div>
    </div>
  );
}

// =====================
// CHECKOUT PAGE
// =====================
function CheckoutPage({ cart, currentUser, placeOrder, setPage, setSelectedOrder }) {
  const [form, setForm] = useState({ name:currentUser?.name||"", phone:currentUser?.phone||"", area:"", address:"", notes:"", payment:"cash" });
  const [errors, setErrors] = useState({});
  const [loading, setLoading] = useState(false);

  const sub = cart.reduce((s,i) => s + i.price*i.qty, 0);
  const delivery = sub > 15 ? 0 : 1.500;
  const total = sub + delivery;

  if (!cart.length) { setPage("shop"); return null; }

  const validate = () => {
    const e = {};
    if (!form.name.trim()) e.name = "Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨";
    if (!form.phone.match(/^[569]\d{7}$/)) e.phone = "Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­";
    if (!form.area) e.area = "Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©";
    if (!form.address.trim()) e.address = "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨";
    setErrors(e);
    return !Object.keys(e).length;
  };

  const submit = () => {
    if (!validate()) return;
    setLoading(true);
    setTimeout(() => {
      const order = placeOrder({ customerName:form.name, customerEmail:currentUser.email, customerPhone:form.phone, userId:currentUser.id, area:form.area, address:form.address, notes:form.notes, payment:form.payment, items:cart, subtotal:sub, delivery, total });
      setSelectedOrder(order);
      setLoading(false);
      setPage("receipt");
    }, 800);
  };

  const ff = (label, field, type="text", placeholder="") => (
    <div style={{ marginBottom:16 }}>
      <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>{label}</label>
      <input className="input-field" type={type} value={form[field]} placeholder={placeholder}
        onChange={e => setForm({...form,[field]:e.target.value})} />
      {errors[field] && <div style={{ color:"var(--danger)", fontSize:12, marginTop:4 }}>{errors[field]}</div>}
    </div>
  );

  return (
    <div className="container" style={{ padding:"40px 20px" }}>
      <h1 className="page-title" style={{ marginBottom:28 }}>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h1>
      <div className="checkout-grid" style={{ display:"grid", gridTemplateColumns:"1fr 340px", gap:28 }}>
        <div>
          <div className="card" style={{ padding:22, marginBottom:18 }}>
            <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:18 }}>ğŸ“ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
            {ff("Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *","name","text","Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…")}
            <div className="grid-2">
              <div>
                {ff("Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *","phone","tel","5xxxxxxx")}
                {errors.phone && <div style={{ color:"var(--danger)", fontSize:12, marginTop:-10, marginBottom:8 }}>{errors.phone}</div>}
              </div>
              <div style={{ marginBottom:16 }}>
                <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
                <select className="input-field" value={form.area} onChange={e => setForm({...form,area:e.target.value})}>
                  <option value="">Ø§Ø®ØªØ±</option>
                  {AREAS.map(a => <option key={a} value={a}>{a}</option>)}
                </select>
                {errors.area && <div style={{ color:"var(--danger)", fontSize:12, marginTop:4 }}>{errors.area}</div>}
              </div>
            </div>
            <div style={{ marginBottom:16 }}>
              <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ *</label>
              <textarea className="input-field" rows={2} value={form.address} onChange={e => setForm({...form,address:e.target.value})} placeholder="Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰ØŒ Ø§Ù„Ø´Ù‚Ø©..." style={{ resize:"vertical" }} />
              {errors.address && <div style={{ color:"var(--danger)", fontSize:12, marginTop:4 }}>{errors.address}</div>}
            </div>
            <div>
              <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <textarea className="input-field" rows={2} value={form.notes} onChange={e => setForm({...form,notes:e.target.value})} style={{ resize:"vertical" }} />
            </div>
          </div>
          <div className="card" style={{ padding:22 }}>
            <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:16 }}>ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h3>
            {[["cash","Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… ğŸ’µ"],["card","Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ© ğŸ’³"],["transfer","ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ ğŸ¦"]].map(([v,l]) => (
              <label key={v} style={{ display:"flex", alignItems:"center", gap:10, padding:13, marginBottom:9, background:"var(--bg3)", borderRadius:10, cursor:"pointer", border:"1.5px solid", borderColor:form.payment===v?"var(--gold)":"var(--border)" }}>
                <input type="radio" name="pay" value={v} checked={form.payment===v} onChange={() => setForm({...form,payment:v})} style={{ accentColor:"var(--gold)" }} />
                <span style={{ fontWeight:600, fontSize:14 }}>{l}</span>
              </label>
            ))}
          </div>
        </div>
        <div>
          <div className="card" style={{ padding:22, position:"sticky", top:80 }}>
            <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:18 }}>ğŸ›’ Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h3>
            <div style={{ maxHeight:190, overflowY:"auto", marginBottom:14 }}>
              {cart.map(i => (
                <div key={i.id} style={{ display:"flex", justifyContent:"space-between", padding:"7px 0", borderBottom:"1px solid var(--border)", fontSize:13, color:"var(--muted)" }}>
                  <span>{i.name} Ã—{i.qty}</span><span>{kwd(i.price*i.qty)}</span>
                </div>
              ))}
            </div>
            {[["Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ",kwd(sub)],["Ø§Ù„ØªÙˆØµÙŠÙ„",delivery===0?"Ù…Ø¬Ø§Ù†ÙŠ ğŸ‰":kwd(delivery)]].map(([l,v]) => (
              <div key={l} style={{ display:"flex", justifyContent:"space-between", padding:"7px 0", color:"var(--muted)", fontSize:14 }}><span>{l}</span><span>{v}</span></div>
            ))}
            <div style={{ display:"flex", justifyContent:"space-between", padding:"14px 0 0", marginTop:8, borderTop:"2px solid var(--border)", fontSize:19, fontWeight:900 }}>
              <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span style={{ color:"var(--gold)" }}>{kwd(total)}</span>
            </div>
            <button className="btn-gold" onClick={submit} disabled={loading} style={{ width:"100%", padding:14, fontSize:15, marginTop:18 }}>
              {loading ? "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©..." : `Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ â€¢ ${kwd(total)}`}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}

// =====================
// RECEIPT PAGE
// =====================
function ReceiptPage({ selectedOrder: o, setPage }) {
  if (!o) { setPage("home"); return null; }
  return (
    <div className="container" style={{ padding:"40px 20px", maxWidth:580 }}>
      <div className="card" style={{ padding:38, textAlign:"center" }}>
        <div style={{ fontSize:64, marginBottom:14 }}>ğŸ‰</div>
        <h1 style={{ color:"var(--success)", marginBottom:8, fontWeight:900, fontSize:26 }}>ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ!</h1>
        <p style={{ color:"var(--muted)", marginBottom:28 }}>Ø´ÙƒØ±Ø§Ù‹ {o.customerName}ØŒ Ø³ÙŠØµÙ„ Ø·Ù„Ø¨Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
        <div style={{ background:"var(--bg3)", borderRadius:12, padding:20, marginBottom:20, textAlign:"right" }}>
          <div style={{ display:"flex", justifyContent:"space-between", marginBottom:10 }}>
            <span style={{ color:"var(--gold)", fontWeight:800, fontSize:18 }}>{o.id}</span>
            <span style={{ color:"var(--muted)", fontSize:12 }}>{o.date} {o.time}</span>
          </div>
          {o.items.map(i => (
            <div key={i.id} style={{ display:"flex", justifyContent:"space-between", padding:"5px 0", borderBottom:"1px solid var(--border)", color:"var(--muted)", fontSize:13 }}>
              <span>{i.name} Ã—{i.qty}</span><span>{kwd(i.price*i.qty)}</span>
            </div>
          ))}
          <div style={{ display:"flex", justifyContent:"space-between", padding:"12px 0 0", fontWeight:900, fontSize:17 }}>
            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span style={{ color:"var(--gold)" }}>{kwd(o.total)}</span>
          </div>
        </div>
        <div style={{ background:"rgba(94,201,138,.1)", border:"1px solid rgba(94,201,138,.3)", borderRadius:10, padding:12, marginBottom:22, color:"var(--success)", fontSize:13, textAlign:"right" }}>
          ğŸ“ Ø§Ù„ØªÙˆØµÙŠÙ„: {o.area} â€” {o.address}
        </div>
        <div style={{ display:"flex", gap:10, justifyContent:"center", flexWrap:"wrap" }}>
          <button className="btn-gold" onClick={() => setPage("orders")}>Ø·Ù„Ø¨Ø§ØªÙŠ</button>
          <button className="btn-outline" onClick={() => setPage("shop")}>Ù…ÙˆØ§ØµÙ„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</button>
        </div>
      </div>
    </div>
  );
}

// =====================
// MY ORDERS PAGE
// =====================
function MyOrdersPage({ orders, currentUser, setPage, setSelectedOrder }) {
  if (!currentUser) { setPage("login"); return null; }
  const mine = orders.filter(o => o.userId === currentUser.id || o.customerEmail === currentUser.email);
  return (
    <div className="container" style={{ padding:"40px 20px" }}>
      <h1 className="page-title" style={{ marginBottom:28 }}>Ø·Ù„Ø¨Ø§ØªÙŠ</h1>
      {!mine.length ? (
        <div style={{ textAlign:"center", padding:"80px 20px" }}>
          <div style={{ fontSize:64, opacity:.3, marginBottom:16 }}>ğŸ“¦</div>
          <h3 style={{ color:"var(--muted)" }}>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</h3>
          <button className="btn-gold" onClick={() => setPage("shop")} style={{ marginTop:20 }}>ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†</button>
        </div>
      ) : mine.map(o => (
        <div key={o.id} className="card" style={{ padding:20, marginBottom:14, cursor:"pointer" }} onClick={() => { setSelectedOrder(o); setPage("receipt"); }}>
          <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center", marginBottom:12 }}>
            <span style={{ color:"var(--gold)", fontWeight:800, fontSize:17 }}>{o.id}</span>
            <span style={{ background:`${STATUS_COLOR[o.status]}20`, color:STATUS_COLOR[o.status], border:`1px solid ${STATUS_COLOR[o.status]}50`, padding:"3px 12px", borderRadius:18, fontSize:12, fontWeight:700 }}>
              {STATUS_MAP[o.status]}
            </span>
          </div>
          <div style={{ color:"var(--muted)", fontSize:13, marginBottom:10 }}>{o.items?.length} Ù…Ù†ØªØ¬Ø§Øª â€¢ {o.date} {o.time}</div>
          <div style={{ display:"flex", justifyContent:"space-between" }}>
            <span style={{ color:"var(--muted)", fontSize:13 }}>ğŸ“ {o.area}</span>
            <span style={{ color:"var(--gold)", fontWeight:900, fontSize:17 }}>{kwd(o.total)}</span>
          </div>
        </div>
      ))}
    </div>
  );
}

// =====================
// LOGIN PAGE
// =====================
function LoginPage({ login, setPage }) {
  const [email, setEmail] = useState("admin@giftstar.kw");
  const [pass, setPass] = useState("Admin@2024");
  const [err, setErr] = useState("");
  const [loading, setLoading] = useState(false);

  const submit = () => {
    setLoading(true); setErr("");
    setTimeout(() => {
      const r = login(email, pass);
      if (r.success) setPage(r.user.role === "admin" ? "admin" : "home");
      else setErr(r.error);
      setLoading(false);
    }, 500);
  };

  return (
    <div style={{ display:"flex", alignItems:"center", justifyContent:"center", minHeight:"80vh", padding:20 }}>
      <div className="card" style={{ padding:38, width:"100%", maxWidth:420 }}>
        <h2 style={{ textAlign:"center", fontWeight:900, fontSize:26, marginBottom:8 }}>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <p style={{ textAlign:"center", color:"var(--muted)", marginBottom:28 }}>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Gift Star âœ¨</p>
        {err && <div style={{ background:"rgba(224,85,85,.1)", border:"1px solid rgba(224,85,85,.3)", color:"var(--danger)", padding:12, borderRadius:10, marginBottom:18, textAlign:"center", fontSize:13 }}>{err}</div>}
        {[["Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ","email",email,setEmail],["ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±","password",pass,setPass]].map(([l,t,v,sv]) => (
          <div key={l} style={{ marginBottom:16 }}>
            <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>{l}</label>
            <input className="input-field" type={t} value={v} onChange={e => sv(e.target.value)} onKeyDown={e => e.key==="Enter"&&submit()} />
          </div>
        ))}
        <button className="btn-gold" onClick={submit} disabled={loading} style={{ width:"100%", padding:13, fontSize:15, marginTop:4 }}>
          {loading ? "â³ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„..." : "Ø¯Ø®ÙˆÙ„"}
        </button>
        <div style={{ marginTop:18, padding:14, background:"var(--bg3)", borderRadius:10, fontSize:12, color:"var(--muted)" }}>
          <div>ğŸ”‘ Ø£Ø¯Ù…Ù†: admin@giftstar.kw / Admin@2024</div>
          <div style={{ marginTop:4 }}>ğŸ‘¤ Ø¹Ù…ÙŠÙ„: ahmed@test.com / 12345678</div>
        </div>
        <p style={{ textAlign:"center", marginTop:18, color:"var(--muted)", fontSize:13 }}>
          Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ{" "}
          <button onClick={() => setPage("register")} style={{ background:"none", border:"none", color:"var(--gold)", cursor:"pointer", fontWeight:700, fontSize:13 }}>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
        </p>
      </div>
    </div>
  );
}

// =====================
// REGISTER PAGE
// =====================
function RegisterPage({ register, setPage }) {
  const [f, setF] = useState({ name:"", email:"", phone:"", password:"", confirm:"" });
  const [err, setErr] = useState("");
  const [loading, setLoading] = useState(false);

  const submit = () => {
    if (!f.name||!f.email||!f.password) { setErr("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return; }
    if (f.password.length < 8) { setErr("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„"); return; }
    if (f.password !== f.confirm) { setErr("ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†"); return; }
    setLoading(true); setErr("");
    setTimeout(() => {
      const r = register(f.name, f.email, f.password, f.phone);
      if (r.success) setPage("home"); else setErr(r.error);
      setLoading(false);
    }, 500);
  };

  const fields = [
    ["name","Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„","text"],["email","Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ","email"],
    ["phone","Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ","tel"],["password","ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±","password"],["confirm","ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±","password"]
  ];

  return (
    <div style={{ display:"flex", alignItems:"center", justifyContent:"center", minHeight:"80vh", padding:20 }}>
      <div className="card" style={{ padding:38, width:"100%", maxWidth:420 }}>
        <h2 style={{ textAlign:"center", fontWeight:900, fontSize:26, marginBottom:8 }}>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</h2>
        <p style={{ textAlign:"center", color:"var(--muted)", marginBottom:28 }}>Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Gift Star ğŸŒŸ</p>
        {err && <div style={{ background:"rgba(224,85,85,.1)", border:"1px solid rgba(224,85,85,.3)", color:"var(--danger)", padding:12, borderRadius:10, marginBottom:18, textAlign:"center", fontSize:13 }}>{err}</div>}
        {fields.map(([field,label,type]) => (
          <div key={field} style={{ marginBottom:14 }}>
            <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:13, marginBottom:5 }}>{label}</label>
            <input className="input-field" type={type} value={f[field]} onChange={e => setF({...f,[field]:e.target.value})} />
          </div>
        ))}
        <button className="btn-gold" onClick={submit} disabled={loading} style={{ width:"100%", padding:13, fontSize:15, marginTop:6 }}>
          {loading ? "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡..." : "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨"}
        </button>
        <p style={{ textAlign:"center", marginTop:18, color:"var(--muted)", fontSize:13 }}>
          Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ{" "}
          <button onClick={() => setPage("login")} style={{ background:"none", border:"none", color:"var(--gold)", cursor:"pointer", fontWeight:700, fontSize:13 }}>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </p>
      </div>
    </div>
  );
}

// =====================
// ADMIN PAGE
// =====================
function AdminPage({ orders, products, users, updateOrderStatus, saveProducts, adminTab, setAdminTab, notifications, unreadCount, markAllRead, showToast, announcements, saveAnnouncements }) {
  const totalRevenue = orders.filter(o => o.status !== "cancelled").reduce((s,o) => s + o.total, 0);
  const todayDate = new Date().toLocaleDateString("ar-KW");
  const todayOrders = orders.filter(o => o.date === todayDate);

  const tabs = [
    ["dashboard","ğŸ“Š Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"],["orders","ğŸ“¦ Ø§Ù„Ø·Ù„Ø¨Ø§Øª"],["products","ğŸ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"],
    ["announcements","ğŸ“¢ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª"],["notifications","ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"],["users","ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"],
  ];

  return (
    <div className="admin-layout" style={{ display:"grid", gridTemplateColumns:"210px 1fr", minHeight:"calc(100vh - 110px)" }}>
      {/* Sidebar */}
      <div className="admin-sidebar" style={{ background:"var(--bg2)", borderLeft:"1px solid var(--border)", padding:16 }}>
        <div style={{ fontSize:12, color:"var(--muted)", fontWeight:700, marginBottom:12, padding:"0 4px" }}>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
        {tabs.map(([id, label]) => (
          <button key={id} className={"admin-sidebar-btn" + (adminTab===id?" active":"")} onClick={() => setAdminTab(id)}>
            {label}
            {id === "notifications" && unreadCount > 0 && (
              <span style={{ position:"absolute", left:10, top:"50%", transform:"translateY(-50%)", background:"var(--danger)", color:"#fff", borderRadius:"50%", width:17, height:17, fontSize:10, fontWeight:900, display:"inline-flex", alignItems:"center", justifyContent:"center" }}>
                {unreadCount}
              </span>
            )}
          </button>
        ))}
      </div>
      {/* Content */}
      <div style={{ padding:28, overflowY:"auto" }}>
        {adminTab === "dashboard"     && <AdminDashboard orders={orders} products={products} users={users} totalRevenue={totalRevenue} todayOrders={todayOrders} />}
        {adminTab === "orders"        && <AdminOrders orders={orders} updateOrderStatus={updateOrderStatus} />}
        {adminTab === "products"      && <AdminProducts products={products} saveProducts={saveProducts} showToast={showToast} />}
        {adminTab === "announcements" && <AdminAnnouncements announcements={announcements} saveAnnouncements={saveAnnouncements} showToast={showToast} />}
        {adminTab === "notifications" && <AdminNotifications notifications={notifications} markAllRead={markAllRead} />}
        {adminTab === "users"         && <AdminUsers users={users} orders={orders} />}
      </div>
    </div>
  );
}

function AdminDashboard({ orders, products, users, totalRevenue, todayOrders }) {
  const stats = [
    { label:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª", value:orders.length, icon:"ğŸ“¦", color:"var(--gold)" },
    { label:"Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…", value:todayOrders.length, icon:"ğŸ—“ï¸", color:"var(--success)" },
    { label:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", value:kwd(totalRevenue), icon:"ğŸ’°", color:"#a78bfa" },
    { label:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª", value:products.length, icon:"ğŸ", color:"#38bdf8" },
    { label:"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", value:users.filter(u=>u.role==="customer").length, icon:"ğŸ‘¥", color:"#fb923c" },
    { label:"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©", value:orders.filter(o=>["new","processing"].includes(o.status)).length, icon:"âš¡", color:"#f59e0b" },
  ];
  return (
    <div>
      <h2 style={{ color:"var(--gold)", fontWeight:900, marginBottom:22 }}>ğŸ“Š Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h2>
      <div className="grid-3" style={{ marginBottom:28 }}>
        {stats.map((s,i) => (
          <div key={i} className="card" style={{ padding:20 }}>
            <div style={{ fontSize:30, marginBottom:8 }}>{s.icon}</div>
            <div style={{ fontSize:22, fontWeight:900, color:s.color }}>{s.value}</div>
            <div style={{ color:"var(--muted)", fontSize:13, marginTop:2 }}>{s.label}</div>
          </div>
        ))}
      </div>
      <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:14 }}>Ø¢Ø®Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
      {!orders.length ? (
        <div style={{ color:"var(--muted)", textAlign:"center", padding:40 }}>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</div>
      ) : orders.slice(0,5).map(o => (
        <div key={o.id} className="card" style={{ padding:15, marginBottom:10, display:"flex", justifyContent:"space-between", alignItems:"center" }}>
          <div>
            <span style={{ color:"var(--gold)", fontWeight:800 }}>{o.id}</span>
            <span style={{ color:"var(--muted)", fontSize:12, marginRight:10 }}>{o.customerName} â€¢ {o.date}</span>
          </div>
          <div style={{ display:"flex", gap:10, alignItems:"center" }}>
            <span style={{ background:`${STATUS_COLOR[o.status]}20`, color:STATUS_COLOR[o.status], border:`1px solid ${STATUS_COLOR[o.status]}50`, padding:"2px 10px", borderRadius:16, fontSize:12, fontWeight:700 }}>
              {STATUS_MAP[o.status]}
            </span>
            <span style={{ color:"var(--gold)", fontWeight:900 }}>{kwd(o.total)}</span>
          </div>
        </div>
      ))}
    </div>
  );
}

function AdminOrders({ orders, updateOrderStatus }) {
  const [filter, setFilter] = useState("all");
  const filtered = filter === "all" ? orders : orders.filter(o => o.status === filter);
  return (
    <div>
      <h2 style={{ color:"var(--gold)", fontWeight:900, marginBottom:22 }}>ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ({orders.length})</h2>
      <div style={{ display:"flex", gap:8, marginBottom:20, flexWrap:"wrap" }}>
        {[["all","Ø§Ù„ÙƒÙ„"],["new","Ø¬Ø¯ÙŠØ¯"],["processing","Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©"],["delivered","Ù…ÙØ³Ù„ÙÙ‘Ù…"],["cancelled","Ù…Ù„ØºÙŠ"]].map(([v,l]) => (
          <button key={v} onClick={() => setFilter(v)} style={{
            padding:"6px 16px", borderRadius:18, border:"1.5px solid",
            borderColor:filter===v?"var(--gold)":"var(--border)",
            background:filter===v?"var(--gold)":"transparent",
            color:filter===v?"#0f0f1a":"var(--muted)",
            cursor:"pointer", fontWeight:700, fontSize:12
          }}>{l} {v!=="all"&&`(${orders.filter(o=>o.status===v).length})`}</button>
        ))}
      </div>
      {!filtered.length ? <div style={{ color:"var(--muted)", textAlign:"center", padding:50 }}>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</div> : filtered.map(o => (
        <div key={o.id} className="card" style={{ padding:20, marginBottom:14 }}>
          <div style={{ display:"flex", justifyContent:"space-between", alignItems:"flex-start", marginBottom:12 }}>
            <div>
              <span style={{ color:"var(--gold)", fontWeight:900, fontSize:17 }}>{o.id}</span>
              <span style={{ color:"var(--muted)", fontSize:12, marginRight:10 }}>{o.date} {o.time}</span>
            </div>
            <span style={{ color:"var(--gold)", fontWeight:900, fontSize:18 }}>{kwd(o.total)}</span>
          </div>
          <div className="grid-2" style={{ marginBottom:12, fontSize:13, color:"var(--muted)" }}>
            <div>ğŸ‘¤ {o.customerName}</div><div>ğŸ“± {o.customerPhone}</div>
            <div>ğŸ“ {o.area} â€” {o.address}</div>
            <div>ğŸ’³ {{cash:"Ù†Ù‚Ø¯Ø§Ù‹",card:"Ø¨Ø·Ø§Ù‚Ø©",transfer:"ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ"}[o.payment]||o.payment}</div>
          </div>
          <div style={{ marginBottom:12 }}>
            {o.items?.map(i => (
              <span key={i.id} style={{ display:"inline-block", background:"var(--bg3)", border:"1px solid var(--border)", borderRadius:8, padding:"2px 10px", margin:"2px", fontSize:12, color:"var(--muted)" }}>
                {i.name} Ã—{i.qty}
              </span>
            ))}
          </div>
          {o.notes && <div style={{ color:"var(--muted)", fontSize:12, marginBottom:12, padding:"7px 12px", background:"var(--bg3)", borderRadius:8 }}>ğŸ’¬ {o.notes}</div>}
          <div style={{ display:"flex", gap:8, flexWrap:"wrap", alignItems:"center" }}>
            <span style={{ fontSize:12, color:"var(--muted)" }}>Ø§Ù„Ø­Ø§Ù„Ø©:</span>
            {Object.entries(STATUS_MAP).map(([v,l]) => (
              <button key={v} onClick={() => updateOrderStatus(o.id, v)} style={{
                padding:"5px 12px", borderRadius:18, border:"1.5px solid",
                borderColor:o.status===v?STATUS_COLOR[v]:"var(--border)",
                background:o.status===v?`${STATUS_COLOR[v]}20`:"transparent",
                color:o.status===v?STATUS_COLOR[v]:"var(--muted)",
                cursor:"pointer", fontSize:12, fontWeight:700
              }}>{l}</button>
            ))}
          </div>
        </div>
      ))}
    </div>
  );
}

function AdminProducts({ products, saveProducts, showToast }) {
  const [editing, setEditing] = useState(null);
  const [showAdd, setShowAdd] = useState(false);
  const [form, setForm] = useState({});

  const startEdit = (p) => { setEditing(p.id); setForm({...p}); setShowAdd(false); };
  const startAdd = () => { setShowAdd(true); setEditing(null); setForm({ id:Date.now(), name:"", cat:"cakes", price:0, img:"", desc:"", badge:"", stock:10, featured:false }); };
  const cancel = () => { setEditing(null); setShowAdd(false); };

  const save = () => {
    if (!form.name||!form.price) { showToast("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©","error"); return; }
    const newP = showAdd ? [form,...products] : products.map(p => p.id===editing?form:p);
    saveProducts(newP);
    showToast(showAdd?"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…":"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…");
    cancel();
  };

  const del = (id) => { saveProducts(products.filter(p => p.id!==id)); showToast("ØªÙ… Ø§Ù„Ø­Ø°Ù"); };

  const ff = (label, field, type="text") => (
    <div>
      <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:4 }}>{label}</label>
      <input className="input-field" type={type} value={form[field]||""} onChange={e => setForm({...form,[field]:type==="number"?parseFloat(e.target.value):e.target.value})} style={{ marginBottom:12 }} />
    </div>
  );

  return (
    <div>
      <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center", marginBottom:22 }}>
        <h2 style={{ color:"var(--gold)", fontWeight:900 }}>ğŸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ({products.length})</h2>
        <button className="btn-gold" onClick={startAdd} style={{ padding:"8px 20px", fontSize:13 }}>+ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</button>
      </div>
      {(editing!==null||showAdd) && (
        <div className="card" style={{ padding:22, marginBottom:22 }}>
          <h3 style={{ color:"var(--gold)", marginBottom:18 }}>{showAdd?"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯":"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"}</h3>
          <div className="grid-2">
            {ff("Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ *","name")}
            <div>
              <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:4 }}>Ø§Ù„ÙØ¦Ø©</label>
              <select className="input-field" value={form.cat||"cakes"} onChange={e => setForm({...form,cat:e.target.value})} style={{ marginBottom:12 }}>
                <option value="cakes">ÙƒÙŠÙƒ</option><option value="flowers">ÙˆØ±Ø¯</option><option value="gifts">Ù‡Ø¯Ø§ÙŠØ§</option>
              </select>
            </div>
            {ff("Ø§Ù„Ø³Ø¹Ø± (Ø¯.Ùƒ) *","price","number")}
            {ff("Ø§Ù„Ù…Ø®Ø²ÙˆÙ†","stock","number")}
          </div>
          {ff("Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©","img")}
          <div>
            <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:4 }}>Ø§Ù„ÙˆØµÙ</label>
            <textarea className="input-field" value={form.desc||""} onChange={e => setForm({...form,desc:e.target.value})} rows={2} style={{ resize:"vertical", marginBottom:12 }} />
          </div>
          <div className="grid-2">
            {ff("Ø´Ø§Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)","badge")}
            <div>
              <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:4 }}>Ù…Ù…ÙŠØ² ÙÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</label>
              <label style={{ display:"flex", alignItems:"center", gap:8, marginTop:6, cursor:"pointer" }}>
                <input type="checkbox" checked={form.featured||false} onChange={e => setForm({...form,featured:e.target.checked})} style={{ width:16, height:16, accentColor:"var(--gold)" }} />
                <span style={{ fontSize:14 }}>Ù†Ø¹Ù…</span>
              </label>
            </div>
          </div>
          <div style={{ display:"flex", gap:10, marginTop:6 }}>
            <button className="btn-gold" onClick={save} style={{ padding:"9px 22px", fontSize:13 }}>ğŸ’¾ Ø­ÙØ¸</button>
            <button className="btn-outline" onClick={cancel} style={{ padding:"9px 22px", fontSize:13 }}>Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </div>
      )}
      <div style={{ display:"flex", flexDirection:"column", gap:10 }}>
        {products.map(p => (
          <div key={p.id} className="card" style={{ padding:14, display:"flex", gap:12, alignItems:"center" }}>
            <img src={p.img} alt={p.name} style={{ width:64, height:64, borderRadius:8, objectFit:"cover", flexShrink:0 }} onError={e => e.target.src="https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=64&h=64&fit=crop"} />
            <div style={{ flex:1 }}>
              <div style={{ fontWeight:800, fontSize:14 }}>{p.name}</div>
              <div style={{ color:"var(--muted)", fontSize:12, marginTop:3 }}>{p.cat} â€¢ Ù…Ø®Ø²ÙˆÙ†: {p.stock} â€¢ {kwd(p.price)}</div>
            </div>
            <div style={{ display:"flex", gap:8 }}>
              <button className="btn-outline" onClick={() => startEdit(p)} style={{ padding:"5px 14px", fontSize:12 }}>ØªØ¹Ø¯ÙŠÙ„</button>
              <button onClick={() => del(p.id)} style={{ padding:"5px 14px", background:"rgba(224,85,85,.1)", border:"1px solid rgba(224,85,85,.3)", color:"var(--danger)", borderRadius:18, cursor:"pointer", fontSize:12 }}>Ø­Ø°Ù</button>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

function AdminAnnouncements({ announcements, saveAnnouncements, showToast }) {
  const [items, setItems] = useState(announcements || []);
  const [newText, setNewText] = useState("");
  const [newColor, setNewColor] = useState("gold");

  useEffect(() => { setItems(announcements || []); }, [announcements]);

  const colorOpts = [
    { value:"gold", label:"Ø°Ù‡Ø¨ÙŠ", bg:"linear-gradient(90deg,#a68840,#c8a96e)" },
    { value:"red",  label:"Ø£Ø­Ù…Ø±",  bg:"linear-gradient(90deg,#c0392b,#e74c3c)" },
    { value:"green",label:"Ø£Ø®Ø¶Ø±", bg:"linear-gradient(90deg,#27ae60,#2ecc71)" },
    { value:"blue", label:"Ø£Ø²Ø±Ù‚",  bg:"linear-gradient(90deg,#2980b9,#3498db)" },
    { value:"dark", label:"Ø¯Ø§ÙƒÙ†",  bg:"linear-gradient(90deg,#1a1a2e,#2d2d4e)" },
  ];

  const add = () => {
    if (!newText.trim()) { showToast("Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†","error"); return; }
    const updated = [...items, { id:Date.now(), text:newText.trim(), active:true, color:newColor }];
    setItems(updated); saveAnnouncements(updated); setNewText(""); setNewColor("gold");
    showToast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† âœ…");
  };
  const toggle = (id) => { const u=items.map(a=>a.id===id?{...a,active:!a.active}:a); setItems(u); saveAnnouncements(u); };
  const del = (id) => { const u=items.filter(a=>a.id!==id); setItems(u); saveAnnouncements(u); showToast("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"); };

  return (
    <div>
      <h2 style={{ color:"var(--gold)", fontWeight:900, marginBottom:8 }}>ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h2>
      <p style={{ color:"var(--muted)", fontSize:13, marginBottom:24 }}>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ù„ÙˆÙ† Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹. ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø£ÙƒØ«Ø± Ù…Ù† Ø¥Ø¹Ù„Ø§Ù† ÙˆØ³ÙŠØªÙ… ØªØ¨Ø¯ÙŠÙ„Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>

      <div className="card" style={{ padding:22, marginBottom:24 }}>
        <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:16 }}>+ Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</h3>
        <div style={{ marginBottom:14 }}>
          <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:5 }}>Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
          <input className="input-field" value={newText} onChange={e => setNewText(e.target.value)} placeholder="Ù…Ø«Ø§Ù„: âœ¨ Ø®ØµÙ… 20% Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙŠÙƒ Ø§Ù„ÙŠÙˆÙ… ÙÙ‚Ø·!" onKeyDown={e => e.key==="Enter"&&add()} />
        </div>
        <div style={{ marginBottom:18 }}>
          <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:8 }}>Ù„ÙˆÙ† Ø§Ù„Ø´Ø±ÙŠØ·</label>
          <div style={{ display:"flex", gap:8, flexWrap:"wrap" }}>
            {colorOpts.map(c => (
              <button key={c.value} onClick={() => setNewColor(c.value)} style={{
                padding:"7px 16px", borderRadius:18, border:"2px solid",
                borderColor:newColor===c.value?"#fff":"transparent",
                background:c.bg, color:c.value==="gold"?"#0f0f1a":c.value==="dark"?"#c8a96e":"#fff",
                cursor:"pointer", fontWeight:700, fontSize:12,
                boxShadow:newColor===c.value?"0 0 0 3px rgba(200,169,110,.4)":"none"
              }}>{c.label}</button>
            ))}
          </div>
        </div>
        {newText && (
          <div style={{ marginBottom:16 }}>
            <label style={{ display:"block", fontWeight:700, color:"var(--muted)", fontSize:12, marginBottom:6 }}>Ù…Ø¹Ø§ÙŠÙ†Ø©:</label>
            <div style={{ background:ANN_COLORS[newColor]?.bg, color:ANN_COLORS[newColor]?.color, padding:"8px 16px", borderRadius:8, fontSize:13, fontWeight:600, textAlign:"center" }}>{newText}</div>
          </div>
        )}
        <button className="btn-gold" onClick={add} style={{ padding:"9px 24px", fontSize:13 }}>+ Ø¥Ø¶Ø§ÙØ©</button>
      </div>

      <h3 style={{ color:"var(--gold)", fontWeight:800, marginBottom:14 }}>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ({items.length})</h3>
      {!items.length ? (
        <div style={{ textAlign:"center", padding:44, color:"var(--muted)", background:"var(--bg2)", borderRadius:14, border:"1px solid var(--border)" }}>
          <div style={{ fontSize:36, marginBottom:10 }}>ğŸ“¢</div>
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ø§Ù‹ Ù„ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹.</p>
        </div>
      ) : items.map(ann => {
        const cs = ANN_COLORS[ann.color] || ANN_COLORS.gold;
        return (
          <div key={ann.id} className="card" style={{ padding:16, display:"flex", gap:12, alignItems:"center", marginBottom:10, opacity:ann.active?1:0.5 }}>
            <div style={{ width:5, height:46, borderRadius:4, background:cs.bg, flexShrink:0 }} />
            <div style={{ flex:1 }}>
              <div style={{ fontWeight:700, fontSize:14 }}>{ann.text}</div>
              <div style={{ fontSize:12, color:"var(--muted)", marginTop:3 }}>
                {colorOpts.find(c=>c.value===ann.color)?.label} â€¢ {" "}
                <span style={{ color:ann.active?"var(--success)":"var(--danger)", fontWeight:700 }}>{ann.active?"â— Ù…ÙØ¹Ù‘Ù„":"â— Ù…Ø®ÙÙŠ"}</span>
              </div>
            </div>
            <div style={{ display:"flex", gap:8 }}>
              <button onClick={() => toggle(ann.id)} style={{ padding:"5px 14px", borderRadius:18, border:"1.5px solid", borderColor:ann.active?"var(--success)":"var(--border)", background:ann.active?"rgba(94,201,138,.1)":"transparent", color:ann.active?"var(--success)":"var(--muted)", cursor:"pointer", fontSize:12, fontWeight:700 }}>
                {ann.active?"Ø¥Ø®ÙØ§Ø¡":"Ø¥Ø¸Ù‡Ø§Ø±"}
              </button>
              <button onClick={() => del(ann.id)} style={{ padding:"5px 14px", borderRadius:18, border:"1px solid rgba(224,85,85,.3)", background:"rgba(224,85,85,.1)", color:"var(--danger)", cursor:"pointer", fontSize:12, fontWeight:700 }}>Ø­Ø°Ù</button>
            </div>
          </div>
        );
      })}
    </div>
  );
}

function AdminNotifications({ notifications, markAllRead }) {
  return (
    <div>
      <div style={{ display:"flex", justifyContent:"space-between", alignItems:"center", marginBottom:22 }}>
        <h2 style={{ color:"var(--gold)", fontWeight:900 }}>ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ({notifications.length})</h2>
        {notifications.some(n => !n.read) && (
          <button className="btn-outline" onClick={markAllRead} style={{ fontSize:12, padding:"6px 16px" }}>ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡</button>
        )}
      </div>
      {!notifications.length ? (
        <div style={{ textAlign:"center", padding:56, color:"var(--muted)" }}>
          <div style={{ fontSize:44, marginBottom:14 }}>ğŸ”•</div>
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯</p>
          <p style={{ fontSize:12, marginTop:6 }}>Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</p>
        </div>
      ) : notifications.map(n => (
        <div key={n.id} className="card" style={{ padding:16, marginBottom:10, display:"flex", gap:12, alignItems:"flex-start", background:n.read?"var(--bg2)":"rgba(200,169,110,.05)", borderColor:n.read?"var(--border)":"var(--border2)" }}>
          <span style={{ fontSize:24, flexShrink:0 }}>ğŸ›’</span>
          <div style={{ flex:1 }}>
            <div style={{ fontSize:14, lineHeight:1.6 }}>{n.text}</div>
            <div style={{ fontSize:11, color:"var(--muted)", marginTop:4 }}>{new Date(n.time).toLocaleString("ar-KW")}</div>
          </div>
          {!n.read && <div style={{ width:9, height:9, borderRadius:"50%", background:"var(--gold)", flexShrink:0, marginTop:5 }} />}
        </div>
      ))}
    </div>
  );
}

function AdminUsers({ users, orders }) {
  const customers = users.filter(u => u.role === "customer");
  return (
    <div>
      <h2 style={{ color:"var(--gold)", fontWeight:900, marginBottom:22 }}>ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ({customers.length})</h2>
      {customers.map(u => {
        const uOrders = orders.filter(o => o.customerEmail === u.email);
        const spent = uOrders.reduce((s,o) => s + o.total, 0);
        return (
          <div key={u.id} className="card" style={{ padding:16, marginBottom:10, display:"flex", justifyContent:"space-between", alignItems:"center" }}>
            <div style={{ display:"flex", gap:12, alignItems:"center" }}>
              <div style={{ width:42, height:42, borderRadius:"50%", background:"linear-gradient(135deg,var(--gold),var(--gold-light))", display:"flex", alignItems:"center", justifyContent:"center", fontSize:16, color:"#0f0f1a", fontWeight:900 }}>
                {u.name[0]}
              </div>
              <div>
                <div style={{ fontWeight:800, fontSize:14 }}>{u.name}</div>
                <div style={{ color:"var(--muted)", fontSize:12 }}>{u.email} â€¢ {u.phone}</div>
              </div>
            </div>
            <div style={{ textAlign:"left" }}>
              <div style={{ color:"var(--gold)", fontWeight:800, fontSize:15 }}>{kwd(spent)}</div>
              <div style={{ color:"var(--muted)", fontSize:12 }}>{uOrders.length} Ø·Ù„Ø¨Ø§Øª</div>
            </div>
          </div>
        );
      })}
    </div>
  );
}

// =====================
// RENDER
// =====================
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
