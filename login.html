<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Gift Star</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
<style>
  .auth-page {
    min-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    background: var(--secondary);
    position: relative;
  }
  
  .auth-card {
    background: var(--secondary-light);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-lg);
    padding: 50px;
    width: 100%;
    max-width: 480px;
    box-shadow: var(--shadow-lg);
    position: relative;
    z-index: 2;
    border: 1px solid var(--border);
  }
  
  .auth-card h2 {
    font-size: 32px;
    font-weight: 900;
    color: var(--text);
    margin-bottom: 10px;
    text-align: center;
    font-family: 'Playfair Display', serif;
  }
  
  .auth-sub {
    text-align: center;
    color: var(--text-muted);
    font-size: 15px;
    margin-bottom: 35px;
  }
  
  .form-group {
    margin-bottom: 25px;
  }
  
  .form-label {
    display: block;
    font-size: 14px;
    font-weight: 700;
    color: var(--text-muted);
    margin-bottom: 8px;
  }
  
  .form-input {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: var(--font);
    font-size: 15px;
    color: var(--text);
    background: var(--secondary);
    transition: var(--transition);
    direction: rtl;
  }
  
  .form-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(200,169,110,0.1);
  }
  
  .btn-submit {
    width: 100%;
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    color: var(--secondary);
    border: none;
    padding: 16px;
    border-radius: 50px;
    font-size: 17px;
    font-weight: 800;
    transition: var(--transition);
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(200,169,110,0.3);
  }
  
  .btn-submit:hover { 
    background: linear-gradient(135deg, var(--primary-dark), var(--primary));
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(200,169,110,0.4);
  }
  
  .btn-submit:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .auth-footer {
    text-align: center;
    margin-top: 25px;
    font-size: 14px;
    color: var(--text-muted);
  }
  
  .auth-footer a {
    color: var(--primary);
    font-weight: 700;
    text-decoration: underline;
  }
  
  .alert {
    padding: 16px 20px;
    border-radius: var(--radius-sm);
    margin-bottom: 20px;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
  }
  
  .alert-error {
    background: rgba(224,85,85,0.1);
    color: #e05555;
    border: 1px solid rgba(224,85,85,0.3);
  }
  
  .alert-success {
    background: rgba(94,201,138,0.1);
    color: #5ec98a;
    border: 1px solid rgba(94,201,138,0.3);
  }
  
  .reset-btn {
    margin-top: 20px;
    text-align: center;
  }
  
  .reset-btn button {
    background: none;
    border: 1px solid var(--primary);
    color: var(--primary);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
    transition: var(--transition);
  }
  
  .reset-btn button:hover {
    background: var(--primary);
    color: var(--secondary);
  }
</style>
</head>
<body>
<header class="site-header">
  <div class="header-main">
    <div class="container header-flex">
      <a href="index.html" class="logo">
        <div class="logo-star">â˜…</div>
        <div class="logo-text">
          <span class="logo-gift">Gift</span>
          <span class="logo-star-word">Star</span>
        </div>
      </a>
    </div>
  </div>
</header>

<div class="auth-page">
  <div class="auth-card">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <p class="auth-sub">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Gift Star</p>

    <div id="msgBanner" class="alert alert-error" style="display:none"></div>
    <div id="successBanner" class="alert alert-success" style="display:none"></div>

    <div class="form-group">
      <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <input type="email" id="email" class="form-input" placeholder="example@email.com" dir="ltr" value="admin@giftstar.kw">
    </div>
    
    <div class="form-group">
      <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      <input type="password" id="password" class="form-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" dir="ltr" value="Admin@2024">
    </div>

    <button class="btn-submit" onclick="doLogin()" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>

    <div class="auth-footer">
      Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="register.html">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
    </div>

    <div class="reset-btn">
      <button onclick="resetSystem()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…</button>
    </div>
  </div>
</div>

<!-- Firebase SDK -->
<script type="importmap">
  {
    "imports": {
      "firebase/app": "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js",
      "firebase/auth": "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js"
    }
  }
</script>

<script type="module" src="js/data.js"></script>
<script type="module">
import { login, getCurrentUser } from './js/data.js';

window.doLogin = async function() {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const banner = document.getElementById('msgBanner');
    const successBanner = document.getElementById('successBanner');
    const loginBtn = document.getElementById('loginBtn');
    
    banner.style.display = 'none';
    successBanner.style.display = 'none';
    
    if (!email || !password) {
        banner.textContent = 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„';
        banner.style.display = 'block';
        return;
    }
    
    loginBtn.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
    loginBtn.disabled = true;
    
    const result = await login(email, password);
    
    if (result.success) {
        successBanner.textContent = 'âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...';
        successBanner.style.display = 'block';
        
        setTimeout(() => {
            const redirect = sessionStorage.getItem('giftstar_redirect_after_login') || 
                           (result.user.role === 'admin' ? 'admin/index.html' : 'index.html');
            sessionStorage.removeItem('giftstar_redirect_after_login');
            window.location.href = redirect;
        }, 1000);
    } else {
        banner.textContent = result.error;
        banner.style.display = 'block';
        loginBtn.textContent = 'Ø¯Ø®ÙˆÙ„';
        loginBtn.disabled = false;
    }
};

window.resetSystem = function() {
    localStorage.clear();
    sessionStorage.clear();
    location.reload();
};

// Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø¥Ø°Ø§ ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ù† ØµÙØ­Ø© Ø£Ø®Ø±Ù‰
const params = new URLSearchParams(window.location.search);
if (params.get('msg') === 'login_required') {
    document.getElementById('msgBanner').textContent = 'ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹';
    document.getElementById('msgBanner').style.display = 'block';
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Enter
document.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        doLogin();
    }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
const currentUser = getCurrentUser();
if (currentUser) {
    window.location.href = 'index.html';
}
</script>
</body>
</html>
