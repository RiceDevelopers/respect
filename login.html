<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Gift Star</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
<style>
  .auth-page {
    min-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    background: var(--secondary);
    position: relative;
  }
  
  .auth-card {
    background: var(--secondary-light);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-lg);
    padding: 50px;
    width: 100%;
    max-width: 480px;
    box-shadow: var(--shadow-lg);
    position: relative;
    z-index: 2;
    border: 1px solid var(--border);
  }
  
  .auth-card h2 {
    font-size: 32px;
    font-weight: 900;
    color: var(--text);
    margin-bottom: 10px;
    text-align: center;
    font-family: 'Playfair Display', serif;
  }
  
  .auth-sub {
    text-align: center;
    color: var(--text-muted);
    font-size: 15px;
    margin-bottom: 35px;
  }
  
  .form-group {
    margin-bottom: 25px;
  }
  
  .form-label {
    display: block;
    font-size: 14px;
    font-weight: 700;
    color: var(--text-muted);
    margin-bottom: 8px;
  }
  
  .form-input {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: var(--font);
    font-size: 15px;
    color: var(--text);
    background: var(--secondary);
    transition: var(--transition);
    direction: rtl;
  }
  
  .form-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(200,169,110,0.1);
  }
  
  .btn-submit {
    width: 100%;
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    color: var(--secondary);
    border: none;
    padding: 16px;
    border-radius: 50px;
    font-size: 17px;
    font-weight: 800;
    transition: var(--transition);
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(200,169,110,0.3);
  }
  
  .btn-submit:hover { 
    background: linear-gradient(135deg, var(--primary-dark), var(--primary));
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(200,169,110,0.4);
  }
  
  .btn-submit:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .auth-footer {
    text-align: center;
    margin-top: 25px;
    font-size: 14px;
    color: var(--text-muted);
  }
  
  .auth-footer a {
    color: var(--primary);
    font-weight: 700;
    text-decoration: underline;
  }
  
  .alert {
    padding: 16px 20px;
    border-radius: var(--radius-sm);
    margin-bottom: 20px;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
  }
  
  .alert-error {
    background: rgba(224,85,85,0.1);
    color: #e05555;
    border: 1px solid rgba(224,85,85,0.3);
  }
  
  .alert-success {
    background: rgba(94,201,138,0.1);
    color: #5ec98a;
    border: 1px solid rgba(94,201,138,0.3);
  }
  
  .reset-btn {
    margin-top: 20px;
    text-align: center;
  }
  
  .reset-btn button {
    background: none;
    border: 1px solid var(--primary);
    color: var(--primary);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
    transition: var(--transition);
  }
  
  .reset-btn button:hover {
    background: var(--primary);
    color: var(--secondary);
  }
</style>
</head>
<body>
<header class="site-header">
  <div class="header-main">
    <div class="container header-flex">
      <a href="index.html" class="logo">
        <div class="logo-star">â˜…</div>
        <div class="logo-text">
          <span class="logo-gift">Gift</span>
          <span class="logo-star-word">Star</span>
        </div>
      </a>
    </div>
  </div>
</header>

<div class="auth-page">
  <div class="auth-card">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <p class="auth-sub">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Gift Star</p>

    <div id="msgBanner" class="alert alert-error" style="display:none"></div>
    <div id="successBanner" class="alert alert-success" style="display:none"></div>

    <div class="form-group">
      <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <input type="email" id="email" class="form-input" placeholder="example@email.com" dir="ltr" value="admin@giftstar.kw">
    </div>
    
    <div class="form-group">
      <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      <input type="password" id="password" class="form-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" dir="ltr" value="Admin@2024">
    </div>

    <button class="btn-submit" onclick="doLogin()" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>

    <div class="auth-footer">
      Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="register.html">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
    </div>

    <div class="reset-btn">
      <button onclick="resetSystem()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…</button>
    </div>
  </div>
</div>

<script>
// =========================================
// Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠØ©
// =========================================

// Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function setItem(key, value) {
    try {
        localStorage.setItem('giftstar_' + key, JSON.stringify(value));
        return true;
    } catch (e) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸:', e);
        return false;
    }
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function getItem(key, fallback = null) {
    try {
        const data = localStorage.getItem('giftstar_' + key);
        return data ? JSON.parse(data) : fallback;
    } catch (e) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©:', e);
        return fallback;
    }
}

// =========================================
// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
// =========================================
function resetSystem() {
    console.log('Ø¨Ø¯Ø¡ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…...');
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ±
    const adminUser = {
        id: 1,
        name: "Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ØªØ¬Ø±",
        email: "admin@giftstar.kw",
        password: "Admin@2024",
        role: "admin",
        verified: true,
        createdAt: new Date().toISOString(),
        phone: "51234567"
    };
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ
    const testUser = {
        id: 2,
        name: "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
        email: "ahmed@test.com",
        password: "12345678",
        role: "customer",
        verified: true,
        createdAt: new Date().toISOString(),
        phone: "51234568"
    };
    
    // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const users = [adminUser, testUser];
    setItem('users', users);
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØªØ¬Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
    const products = [
        {
            id: 1,
            name: "ÙƒÙŠÙƒ Ø§Ù„ÙØ±Ø§ÙˆÙ„Ø© Ø§Ù„ÙØ§Ø®Ø±",
            category: "cakes",
            price: 12.500,
            image: "https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=400&h=400&fit=crop",
            description: "ÙƒÙŠÙƒ ÙØ±Ø§ÙˆÙ„Ø© Ø·Ø§Ø²Ø¬Ø© Ø¨ÙƒØ±ÙŠÙ…Ø© Ø§Ù„Ø´Ø§Ù†ØªÙŠÙ‡ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©",
            badge: "Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹",
            featured: true,
            stock: 20,
            active: true
        },
        {
            id: 2,
            name: "Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯ Ø­Ù…Ø±Ø§Ø¡",
            category: "flowers",
            price: 8.750,
            image: "https://images.unsplash.com/photo-1518621736915-f3b1c41bfd00?w=400&h=400&fit=crop",
            description: "24 ÙˆØ±Ø¯Ø© Ø­Ù…Ø±Ø§Ø¡ Ø·Ø§Ø²Ø¬Ø©",
            badge: "Ø¬Ø¯ÙŠØ¯",
            featured: true,
            stock: 30,
            active: true
        }
    ];
    setItem('products', products);
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨Ø§Øª ÙØ§Ø±ØºØ©
    setItem('orders', []);
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±ÙˆØ¶
    const promos = [
        {
            id: 1,
            title: "Ø®ØµÙ… 20% Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙŠÙƒ",
            description: "Ø¹Ø±Ø¶ Ø®Ø§Øµ Ù„ÙØªØ±Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©",
            image: "https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=600&h=300&fit=crop",
            badge: "Ø¹Ø±Ø¶",
            active: true
        }
    ];
    setItem('promos', promos);
    
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    const successBanner = document.getElementById('successBanner');
    successBanner.style.display = 'block';
    successBanner.textContent = 'âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†';
    
    console.log('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…');
    console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:', users);
}

// =========================================
// Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
// =========================================
function doLogin() {
    console.log('Ø¨Ø¯Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
    
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const banner = document.getElementById('msgBanner');
    const successBanner = document.getElementById('successBanner');
    const loginBtn = document.getElementById('loginBtn');
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø§Ù†Ø±Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    banner.style.display = 'none';
    successBanner.style.display = 'none';
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
    if (!email || !password) {
        banner.textContent = 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„';
        banner.style.display = 'block';
        return;
    }
    
    // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø±
    const originalText = loginBtn.textContent;
    loginBtn.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
    loginBtn.disabled = true;
    
    try {
        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        let users = getItem('users', []);
        
        // Ø¥Ø°Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¦Ù‡Ù…
        if (users.length === 0) {
            console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ù…');
            resetSystem();
            users = getItem('users', []);
        }
        
        console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ†:', users);
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const user = users.find(u => u.email === email);
        console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯:', user);
        
        if (!user) {
            banner.textContent = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­';
            banner.style.display = 'block';
            loginBtn.textContent = originalText;
            loginBtn.disabled = false;
            return;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        if (user.password !== password) {
            console.log('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø®Ø²Ù†Ø©:', user.password);
            console.log('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:', password);
            banner.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
            banner.style.display = 'block';
            loginBtn.textContent = originalText;
            loginBtn.disabled = false;
            return;
        }
        
        if (!user.verified) {
            banner.textContent = 'Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙØ¹Ù„';
            banner.style.display = 'block';
            loginBtn.textContent = originalText;
            loginBtn.disabled = false;
            return;
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­
        console.log('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user);
        
        // Ø­ÙØ¸ Ø§Ù„Ø¬Ù„Ø³Ø©
        const sessionUser = {
            id: user.id,
            name: user.name,
            email: user.email,
            role: user.role,
            phone: user.phone
        };
        
        sessionStorage.setItem('giftstar_user', JSON.stringify(sessionUser));
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
        successBanner.textContent = 'âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...';
        successBanner.style.display = 'block';
        
        // Ø§Ù„ØªØ­ÙˆÙŠÙ„
        setTimeout(() => {
            const redirect = sessionStorage.getItem('giftstar_redirect_after_login') || 
                           (user.role === 'admin' ? 'admin/index.html' : 'index.html');
            
            sessionStorage.removeItem('giftstar_redirect_after_login');
            window.location.href = redirect;
        }, 1000);
        
    } catch (error) {
        console.error('Ø®Ø·Ø£:', error);
        banner.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message;
        banner.style.display = 'block';
        loginBtn.textContent = originalText;
        loginBtn.disabled = false;
    }
}

// =========================================
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
// =========================================
const params = new URLSearchParams(window.location.search);
if (params.get('msg') === 'login_required') {
    const banner = document.getElementById('msgBanner');
    banner.textContent = 'ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹';
    banner.style.display = 'block';
}

// =========================================
// Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
// =========================================
document.addEventListener('DOMContentLoaded', function() {
    console.log('ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¬Ø§Ù‡Ø²Ø©');
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const users = getItem('users', []);
    if (users.length === 0) {
        console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
        resetSystem();
    } else {
        console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ†:', users);
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Enter
    document.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            doLogin();
        }
    });
});

// Ø¯ÙˆØ§Ù„ Ù„Ù„ØªØµØ­ÙŠØ­ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
window.checkUsers = function() {
    console.log('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:', getItem('users', []));
};

window.clearAll = function() {
    localStorage.clear();
    sessionStorage.clear();
    location.reload();
};
</script>
</body>
</html>
